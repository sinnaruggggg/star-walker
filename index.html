<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Solar Explorer v2.1 - ìš°ì£¼ íƒí—˜ ì‹œë®¬ë ˆì´í„°</title>
    
    <!-- PWA ì„¤ì • -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0a1628">
    <meta name="description" content="3D íƒœì–‘ê³„ íƒí—˜ ì‹œë®¬ë ˆì´ì…˜ ê²Œì„. ìš°ì£¼ì„ ì„ ì¡°ì¢…í•˜ê³  í–‰ì„±ì„ íƒí—˜í•˜ì„¸ìš”!">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Solar Explorer">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-192x192.png">
    
    <!-- Open Graph / ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ  -->
    <meta property="og:title" content="Solar Explorer - ìš°ì£¼ íƒí—˜ ì‹œë®¬ë ˆì´í„°">
    <meta property="og:description" content="3D íƒœì–‘ê³„ íƒí—˜ ì‹œë®¬ë ˆì´ì…˜ ê²Œì„">
    <meta property="og:type" content="website">
    <meta property="og:image" content="icons/icon-512x512.png">
    
    <!-- MS íƒ€ì¼ -->
    <meta name="msapplication-TileColor" content="#0a1628">
    <meta name="msapplication-TileImage" content="icons/icon-144x144.png">
    
    <link rel="stylesheet" href="css/main.css">
    <!-- Supabase SDK (ë¡œì»¬ íŒŒì¼) -->
    <script src="supabase.min.js"></script>
    <script type="importmap">
        { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/" } }
    </script>
</head>
<body>
<script>console.log('===== ë²„ì „ 2.2 ë¡œë“œë¨ =====');</script>
<!-- â˜…â˜…â˜… ì‹œë„¤ë§ˆí‹± ì¸íŠ¸ë¡œ â˜…â˜…â˜… -->
<div id="intro-overlay">
    <canvas id="intro-canvas"></canvas>
    
    <!-- ë ˆí„°ë°•ìŠ¤ (ì‹œë„¤ë§ˆí‹± ë°”) -->
    <div class="letterbox letterbox-top"></div>
    <div class="letterbox letterbox-bottom"></div>
    
    <!-- ë Œì¦ˆ í”Œë ˆì–´ -->
    <div id="lens-flare"></div>
    
    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div id="intro-content">
        <!-- íšŒì‚¬ ë¡œê³  (Anthropic ìŠ¤íƒ€ì¼) -->
        <div id="studio-logo">
            <div class="studio-icon">â—†</div>
            <div class="studio-text">SINNARU STUDIO</div>
        </div>
        
        <!-- ë©”ì¸ íƒ€ì´í‹€ -->
        <div id="main-title">
            <div class="title-line"></div>
            <div class="title-text">
                <span class="char">S</span><span class="char">T</span><span class="char">A</span><span class="char">R</span>
                <span class="char dot">Â·</span>
                <span class="char">S</span><span class="char">T</span><span class="char">R</span><span class="char">I</span><span class="char">D</span><span class="char">E</span><span class="char">R</span>
            </div>
            <div class="title-line"></div>
            <div class="title-tagline">EXPLORE THE UNIVERSE</div>
        </div>
        
        <!-- ì›í˜• ë¡œë”© -->
        <div id="intro-loader">
            <svg class="loader-ring" viewBox="0 0 100 100">
                <circle class="loader-bg" cx="50" cy="50" r="45"/>
                <circle class="loader-progress" cx="50" cy="50" r="45"/>
            </svg>
            <div class="loader-percent"><span id="intro-percent">0</span>%</div>
        </div>
        
        <!-- ì‹œì‘ ë²„íŠ¼ -->
        <div id="intro-start">
            <button id="intro-start-btn">
                <span class="btn-border"></span>
                <span class="btn-text">PRESS TO LAUNCH</span>
            </button>
        </div>
    </div>
    
    <!-- ìŠ¤í‚µ -->
    <div id="intro-skip">SKIP <span class="skip-arrow">Â»</span></div>
    
    <!-- í•˜ë‹¨ í…ìŠ¤íŠ¸ -->
    <div id="intro-bottom-text">Â© 2025 SINNARU STUDIO. ALL RIGHTS RESERVED.</div>
</div>

<!-- â˜…â˜…â˜… STARÂ·WALKER ë©”ì¸ ë©”ë‰´ â˜…â˜…â˜… -->
<div id="mode-select-overlay" style="display:none;">

<!-- â˜…â˜…â˜… ê³ ì • í—¤ë” ë²„íŠ¼ (ëª¨ë“  í™”ë©´ì—ì„œ í‘œì‹œ) â˜…â˜…â˜… -->
<div id="global-header-btns">
    <button id="global-profile-btn" class="global-header-btn" title="Profile">
        <span class="btn-icon">ğŸ‘¤</span>
    </button>
    <button id="global-settings-btn" class="global-header-btn" title="Settings">
        <span class="btn-icon">âš™ï¸</span>
    </button>
</div>

<!-- â˜…â˜…â˜… ê°€ë¡œëª¨ë“œ íšŒì „ ì•ˆë‚´ â˜…â˜…â˜… -->
<div id="rotate-screen-overlay">
    <div class="rotate-content">
        <div class="rotate-icon">ğŸ“±</div>
        <div class="rotate-arrow">â†»</div>
        <div class="rotate-text">Please rotate your device</div>
        <div class="rotate-subtext">ê°€ë¡œ ëª¨ë“œë¡œ ì „í™˜í•´ì£¼ì„¸ìš”</div>
    </div>
</div>
    <!-- ë°°ê²½ íš¨ê³¼ -->
    <div class="voyager-bg-stars"></div>
    <div class="voyager-bg-nebula"></div>
    
    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="voyager-main-content">
        <!-- ë¡œê³  -->
        <div class="voyager-logo">
            <div class="voyager-logo-icon">âœ¦</div>
            <div class="voyager-logo-text">STAR<span class="logo-dot">Â·</span>WALKER</div>
            <div class="voyager-logo-tagline">SPACE EXPLORATION SIMULATOR</div>
        </div>
        
        <!-- ë©”ë‰´ ë²„íŠ¼ë“¤ -->
        <div class="voyager-menu">
            <button id="btn-single" class="voyager-btn primary">
                <div class="btn-icon">ğŸŒŒ</div>
                <div class="btn-content">
                    <div class="btn-title" data-i18n="singlePlay">Single Play</div>
                    <div class="btn-desc" data-i18n="singleDesc">Free space exploration â€¢ Create celestial bodies â€¢ Unlimited</div>
                </div>
                <div class="btn-arrow">â€º</div>
            </button>
            
            <button id="btn-multi" class="voyager-btn secondary">
                <div class="btn-icon">ğŸŒ</div>
                <div class="btn-content">
                    <div class="btn-title" data-i18n="multiPlay">Multiplayer</div>
                    <div class="btn-desc" data-i18n="multiDesc">Real-time chat â€¢ Co-op exploration â€¢ Competition</div>
                </div>
                <div class="btn-arrow">â€º</div>
            </button>
            
            <button id="btn-login-main" class="voyager-btn tertiary">
                <div class="btn-icon">ğŸ”‘</div>
                <div class="btn-content">
                    <div class="btn-title" data-i18n="loginBtn">Login</div>
                    <div class="btn-desc" data-i18n="loginDesc">Account sync â€¢ Save progress â€¢ Rankings</div>
                </div>
                <div class="btn-arrow">â€º</div>
            </button>
            
            <div class="voyager-btn-row" style="justify-content: center;">
                <button id="btn-settings" class="voyager-btn-small">
                    <div class="btn-icon">âš™ï¸</div>
                    <div class="btn-title" data-i18n="settings">Settings</div>
                </button>
            </div>
        </div>
        
        <!-- í•˜ë‹¨ ì •ë³´ -->
        <div class="voyager-footer">
            <div class="voyager-version">v1.0</div>
        </div>

        <!-- â˜…â˜…â˜… ì—ì…‹ ë‹¤ìš´ë¡œë“œ ì§„í–‰ í‘œì‹œ â˜…â˜…â˜… -->
        <div id="asset-download-status" style="display:none;">
            <div class="download-icon">ğŸ“¦</div>
            <div class="download-text">ê²Œì„ ë°ì´í„° ë‹¤ìš´ë¡œë“œ ì¤‘...</div>
            <div class="download-progress-bar">
                <div class="download-progress-fill" id="download-progress-fill"></div>
            </div>
            <div class="download-info" id="download-info">0 / 0 íŒŒì¼</div>
        </div>
    </div>
</div>

<style>
/* â˜…â˜…â˜… ì—ì…‹ ë‹¤ìš´ë¡œë“œ ìƒíƒœ í‘œì‹œ â˜…â˜…â˜… */
#asset-download-status {
    position: absolute;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 20, 40, 0.9);
    border: 1px solid rgba(0, 255, 255, 0.3);
    border-radius: 10px;
    padding: 12px 20px;
    text-align: center;
    min-width: 200px;
}
#asset-download-status .download-icon {
    font-size: 20px;
    margin-bottom: 5px;
}
#asset-download-status .download-text {
    color: #8cf;
    font-size: 11px;
    margin-bottom: 8px;
}
#asset-download-status .download-progress-bar {
    width: 100%;
    height: 6px;
    background: rgba(0, 50, 100, 0.5);
    border-radius: 3px;
    overflow: hidden;
}
#asset-download-status .download-progress-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #0ff, #0f8);
    transition: width 0.3s;
}
#asset-download-status .download-info {
    color: #68a;
    font-size: 10px;
    margin-top: 5px;
}
#asset-download-status.complete {
    border-color: #2ecc71;
}
#asset-download-status.complete .download-text {
    color: #2ecc71;
}

/* â˜…â˜…â˜… STARÂ·WALKER ë©”ì¸ ë©”ë‰´ ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
#mode-select-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: linear-gradient(135deg, #0a0a1a 0%, #0d1b2a 50%, #1b263b 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 99999;
    overflow: hidden;
}

/* ë°°ê²½ ë³„ íš¨ê³¼ */
.voyager-bg-stars {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-image: 
        radial-gradient(2px 2px at 20px 30px, #fff, transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
        radial-gradient(1px 1px at 90px 40px, #fff, transparent),
        radial-gradient(2px 2px at 160px 120px, rgba(0,255,255,0.6), transparent),
        radial-gradient(1px 1px at 230px 80px, #fff, transparent),
        radial-gradient(2px 2px at 300px 150px, rgba(255,255,255,0.7), transparent);
    background-size: 350px 200px;
    animation: starFloat 60s linear infinite;
    opacity: 0.6;
}

/* ì„±ìš´ íš¨ê³¼ */
.voyager-bg-nebula {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: 
        radial-gradient(ellipse at 20% 80%, rgba(0, 150, 255, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(0, 255, 200, 0.05) 0%, transparent 70%);
    animation: nebulaShift 30s ease-in-out infinite alternate;
}

@keyframes starFloat {
    0% { transform: translateY(0); }
    100% { transform: translateY(-200px); }
}

@keyframes nebulaShift {
    0% { opacity: 0.8; }
    100% { opacity: 1; }
}

/* ë©”ì¸ ì»¨í…ì¸  */
.voyager-main-content {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    max-width: 400px;
    width: 100%;
}

/* ë¡œê³  */
.voyager-logo {
    text-align: center;
    margin-bottom: 40px;
}

.voyager-logo-icon {
    font-size: 60px;
    margin-bottom: 10px;
    animation: logoFloat 3s ease-in-out infinite;
    filter: drop-shadow(0 0 20px rgba(0, 200, 255, 0.5));
}

@keyframes logoFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.voyager-logo-text {
    font-family: 'Orbitron', 'Rajdhani', sans-serif;
    font-size: 42px;
    font-weight: 900;
    letter-spacing: 4px;
    background: linear-gradient(135deg, #00d4ff 0%, #00ff88 50%, #00d4ff 100%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: logoShine 3s linear infinite;
    text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
}

.voyager-logo-text .logo-dot {
    color: #fff;
    -webkit-text-fill-color: #fff;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    animation: dotPulse 2s ease-in-out infinite;
}

@keyframes dotPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes logoShine {
    0% { background-position: 0% center; }
    100% { background-position: 200% center; }
}

.voyager-logo-tagline {
    font-family: 'Orbitron', sans-serif;
    font-size: 10px;
    letter-spacing: 4px;
    color: rgba(0, 212, 255, 0.7);
    margin-top: 8px;
}

/* ë©”ë‰´ */
.voyager-menu {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 100%;
}

/* ë©”ì¸ ë²„íŠ¼ */
.voyager-btn {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 16px 20px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    text-align: left;
}

.voyager-btn::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
    transition: left 0.5s;
}

.voyager-btn:hover::before {
    left: 100%;
}

.voyager-btn:active {
    transform: scale(0.98);
}

/* Primary ë²„íŠ¼ (ì‹±ê¸€) */
.voyager-btn.primary {
    background: linear-gradient(135deg, rgba(0, 100, 150, 0.8) 0%, rgba(0, 150, 200, 0.6) 100%);
    border: 2px solid rgba(0, 200, 255, 0.5);
    box-shadow: 0 0 20px rgba(0, 200, 255, 0.2), inset 0 1px 0 rgba(255,255,255,0.1);
}

.voyager-btn.primary:hover {
    border-color: rgba(0, 255, 255, 0.8);
    box-shadow: 0 0 30px rgba(0, 255, 255, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

/* Secondary ë²„íŠ¼ (ë©€í‹°) */
.voyager-btn.secondary {
    background: linear-gradient(135deg, rgba(100, 50, 150, 0.8) 0%, rgba(150, 80, 200, 0.6) 100%);
    border: 2px solid rgba(180, 100, 255, 0.5);
    box-shadow: 0 0 20px rgba(150, 100, 255, 0.2), inset 0 1px 0 rgba(255,255,255,0.1);
}

.voyager-btn.secondary:hover {
    border-color: rgba(200, 150, 255, 0.8);
    box-shadow: 0 0 30px rgba(180, 100, 255, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

/* Tertiary ë²„íŠ¼ (ë¯¸ì…˜) */
.voyager-btn.tertiary {
    background: linear-gradient(135deg, rgba(150, 100, 0, 0.8) 0%, rgba(200, 150, 50, 0.6) 100%);
    border: 2px solid rgba(255, 200, 100, 0.5);
    box-shadow: 0 0 20px rgba(255, 180, 50, 0.2), inset 0 1px 0 rgba(255,255,255,0.1);
}

.voyager-btn.tertiary:hover {
    border-color: rgba(255, 220, 150, 0.8);
    box-shadow: 0 0 30px rgba(255, 200, 100, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.voyager-btn .btn-icon {
    font-size: 28px;
    margin-right: 15px;
    filter: drop-shadow(0 0 5px rgba(255,255,255,0.3));
}

.voyager-btn .btn-content {
    flex: 1;
}

.voyager-btn .btn-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 16px;
    font-weight: 700;
    color: #fff;
    margin-bottom: 4px;
}

.voyager-btn .btn-desc {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.7);
}

.voyager-btn .btn-arrow {
    font-size: 24px;
    color: rgba(255, 255, 255, 0.5);
    transition: transform 0.3s;
}

.voyager-btn:hover .btn-arrow {
    transform: translateX(5px);
    color: rgba(255, 255, 255, 0.9);
}

/* ì‘ì€ ë²„íŠ¼ í–‰ */
.voyager-btn-row {
    display: flex;
    gap: 12px;
    margin-top: 8px;
}

.voyager-btn-small {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 15px;
    background: linear-gradient(135deg, rgba(50, 50, 70, 0.8) 0%, rgba(70, 70, 90, 0.6) 100%);
    border: 2px solid rgba(100, 100, 150, 0.5);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.voyager-btn-small:hover {
    border-color: rgba(150, 150, 200, 0.8);
    box-shadow: 0 0 20px rgba(100, 100, 200, 0.3);
}

.voyager-btn-small:active {
    transform: scale(0.95);
}

.voyager-btn-small .btn-icon {
    font-size: 24px;
    margin-bottom: 5px;
}

.voyager-btn-small .btn-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.9);
}

/* í‘¸í„° */
.voyager-footer {
    margin-top: 30px;
    text-align: center;
}

.voyager-version {
    font-family: 'Orbitron', sans-serif;
    font-size: 10px;
    color: rgba(255, 255, 255, 0.3);
    letter-spacing: 2px;
}

/* ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 480px) {
    .voyager-logo-text {
        font-size: 36px;
        letter-spacing: 5px;
    }
    
    .voyager-logo-icon {
        font-size: 50px;
    }
    
    .voyager-logo-tagline {
        font-size: 8px;
        letter-spacing: 2px;
    }
    
    .voyager-btn {
        padding: 14px 16px;
    }
    
    .voyager-btn .btn-icon {
        font-size: 24px;
        margin-right: 12px;
    }
    
    .voyager-btn .btn-title {
        font-size: 14px;
    }
    
    .voyager-btn .btn-desc {
        font-size: 10px;
    }
}

/* ìŠ¤ìº”ë¼ì¸ íš¨ê³¼ (ì„ íƒì ) */
#mode-select-overlay::after {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.03) 2px,
        rgba(0, 0, 0, 0.03) 4px
    );
    pointer-events: none;
}
</style>

<!-- â˜…â˜…â˜… ì„¤ì • ëª¨ë‹¬ â˜…â˜…â˜… -->
<div id="settings-modal" class="voyager-modal">
    <div class="voyager-modal-content">
        <div class="voyager-modal-header">
            <div class="modal-title" data-i18n="settings">âš™ï¸ ì„¤ì •</div>
            <button class="modal-close" id="settings-close">âœ•</button>
        </div>
        <div class="voyager-modal-body">
            <div class="settings-section">
                <div class="settings-label" data-i18n="sound">ğŸ”Š ì†Œë¦¬</div>
                <div class="settings-control">
                    <input type="range" id="settings-volume" min="0" max="100" value="50">
                    <span id="settings-volume-val">50%</span>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-label" data-i18n="graphics">ğŸ¨ ê·¸ë˜í”½</div>
                <div class="settings-control">
                    <select id="settings-graphics">
                        <option value="low" data-i18n="graphicsLow">ë‚®ìŒ</option>
                        <option value="medium" selected data-i18n="graphicsMedium">ì¤‘ê°„</option>
                        <option value="high" data-i18n="graphicsHigh">ë†’ìŒ</option>
                    </select>
                </div>
            </div>
            <div class="settings-section">
                <div class="settings-label" data-i18n="language">ğŸŒ ì–¸ì–´</div>
                <div class="settings-control">
                    <select id="settings-language">
                        <option value="en" selected>English</option>
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="zh">ä¸­æ–‡</option>
                        <option value="fr">FranÃ§ais</option>
                        <option value="la">Latina</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- â˜…â˜…â˜… ì²œì²´ ì •ë³´ íŒì—… (í„°ì¹˜ ì‹œ í‘œì‹œ) â˜…â˜…â˜… -->
<div id="body-info-popup" class="body-info-popup">
    <div class="popup-header">
        <span class="popup-icon">ğŸŒ</span>
        <span class="popup-name">Earth</span>
        <span class="popup-type">Planet</span>
    </div>
    <div class="popup-stats">
        <div class="stat-row"><span class="stat-label" data-i18n="bodyRadius">ë°˜ì§€ë¦„</span><span class="stat-value" id="popup-radius">6,371 km</span></div>
        <div class="stat-row"><span class="stat-label" data-i18n="bodyMass">ì§ˆëŸ‰</span><span class="stat-value" id="popup-mass">5.97Ã—10Â²â´ kg</span></div>
        <div class="stat-row"><span class="stat-label" data-i18n="bodyDistance">ê±°ë¦¬</span><span class="stat-value" id="popup-distance">0 km</span></div>
    </div>
    <button class="popup-detail-btn" id="popup-detail-btn" data-i18n="bodyDetailBtn">ğŸ“– ìƒì„¸ë³´ê¸°</button>
</div>

<!-- â˜…â˜…â˜… ì²œì²´ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ â˜…â˜…â˜… -->
<div id="body-detail-modal" class="body-detail-modal">
    <div class="detail-modal-content">
        <button class="detail-close-btn" id="body-detail-close">âœ•</button>
        
        <div class="detail-header">
            <div class="detail-icon-wrap">
                <div class="detail-icon">ğŸŒ</div>
            </div>
            <div class="detail-title-wrap">
                <h2 class="detail-name">Earth</h2>
                <span class="detail-type">Rocky Planet</span>
            </div>
        </div>
        
        <div class="detail-body">
            <div class="detail-section">
                <h3 data-i18n="bodyBasicInfo">ğŸ“Š ê¸°ë³¸ ì •ë³´</h3>
                <div class="detail-grid">
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyRadius">ë°˜ì§€ë¦„</span>
                        <span class="item-value" id="detail-radius">6,371 km</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyMass">ì§ˆëŸ‰</span>
                        <span class="item-value" id="detail-mass">5.97Ã—10Â²â´ kg</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyRotation">ìì „ ì†ë„</span>
                        <span class="item-value" id="detail-rotation">1 day</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodySurfaceGravity">í‘œë©´ ì¤‘ë ¥</span>
                        <span class="item-value" id="detail-gravity">9.8 m/sÂ²</span>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h3 data-i18n="bodyOrbitInfo">ğŸ›°ï¸ ê¶¤ë„ ì •ë³´</h3>
                <div class="detail-grid">
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyDistance">í˜„ì¬ ê±°ë¦¬</span>
                        <span class="item-value" id="detail-distance">149.6M km</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyOrbitalSpeed">ê³µì „ ì†ë„</span>
                        <span class="item-value" id="detail-orbital-speed">29.78 km/s</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyMoons">ìœ„ì„± ìˆ˜</span>
                        <span class="item-value" id="detail-moons">1</span>
                    </div>
                    <div class="detail-item">
                        <span class="item-label" data-i18n="bodyRings">ê³ ë¦¬</span>
                        <span class="item-value" id="detail-rings" data-i18n="none">ì—†ìŒ</span>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h3 data-i18n="bodyDescription">ğŸ“ ì„¤ëª…</h3>
                <p class="detail-description" id="detail-description">
                    ì§€êµ¬ëŠ” íƒœì–‘ê³„ì—ì„œ ì„¸ ë²ˆì§¸ í–‰ì„±ì´ë©°, ì•Œë ¤ì§„ ìœ ì¼í•œ ìƒëª…ì²´ê°€ ì¡´ì¬í•˜ëŠ” ì²œì²´ì…ë‹ˆë‹¤.
                </p>
            </div>
            
            <div class="detail-actions">
                <button class="detail-action-btn" id="detail-focus-btn" data-i18n="bodyFocusBtn">ğŸ¯ ì¶”ì í•˜ê¸°</button>
                <button class="detail-action-btn" id="detail-nav-btn" data-i18n="bodyNavBtn">ğŸ§­ í•­ë²• ëª©í‘œ ì„¤ì •</button>
            </div>
        </div>
    </div>
</div>

<style>
/* â˜…â˜…â˜… ì²œì²´ ì •ë³´ íŒì—… ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
.body-info-popup {
    position: fixed;
    display: none;
    background: linear-gradient(135deg, rgba(10, 20, 40, 0.95) 0%, rgba(5, 15, 35, 0.98) 100%);
    border: 2px solid rgba(0, 200, 255, 0.5);
    border-radius: 12px;
    padding: 12px 15px;
    min-width: 180px;
    max-width: 220px;
    z-index: 2000;
    pointer-events: auto;
    box-shadow: 0 0 30px rgba(0, 200, 255, 0.3), inset 0 0 20px rgba(0, 100, 150, 0.1);
    backdrop-filter: blur(10px);
    animation: popupFadeIn 0.3s ease;
    font-family: 'Rajdhani', sans-serif;
}

.body-info-popup::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, #00d4ff, transparent);
}

@keyframes popupFadeIn {
    from { opacity: 0; transform: scale(0.9) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.popup-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 200, 255, 0.2);
}

.popup-icon {
    font-size: 24px;
    filter: drop-shadow(0 0 5px currentColor);
}

.popup-name {
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: #00d4ff;
    flex: 1;
}

.popup-type {
    font-size: 10px;
    color: #888;
    background: rgba(0, 200, 255, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    text-transform: uppercase;
}

.popup-stats {
    margin-bottom: 10px;
}

.stat-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 0;
    font-size: 11px;
}

.stat-label {
    color: #888;
}

.stat-value {
    color: #00ff88;
    font-family: 'Orbitron', monospace;
    font-size: 10px;
}

.popup-detail-btn {
    width: 100%;
    padding: 8px;
    background: linear-gradient(135deg, rgba(0, 150, 255, 0.3) 0%, rgba(0, 100, 200, 0.2) 100%);
    border: 1px solid rgba(0, 200, 255, 0.5);
    border-radius: 6px;
    color: #00d4ff;
    font-family: 'Orbitron', sans-serif;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.3s;
}

.popup-detail-btn:hover {
    background: rgba(0, 200, 255, 0.3);
    box-shadow: 0 0 15px rgba(0, 200, 255, 0.4);
}

/* â˜…â˜…â˜… ì²œì²´ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
.body-detail-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 5, 15, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    backdrop-filter: blur(5px);
    animation: modalFadeIn 0.3s ease;
}

.body-detail-modal.open {
    display: flex;
}

@keyframes modalFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.detail-modal-content {
    background: linear-gradient(180deg, rgba(10, 25, 50, 0.98) 0%, rgba(5, 15, 35, 0.99) 100%);
    border: 2px solid rgba(0, 200, 255, 0.4);
    border-radius: 16px;
    width: 90%;
    max-width: 450px;
    max-height: 85vh;
    overflow-y: auto;
    position: relative;
    box-shadow: 0 0 50px rgba(0, 150, 255, 0.3);
    animation: contentSlideIn 0.4s ease;
}

@keyframes contentSlideIn {
    from { transform: translateY(30px) scale(0.95); opacity: 0; }
    to { transform: translateY(0) scale(1); opacity: 1; }
}

.detail-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 36px;
    height: 36px;
    background: rgba(255, 50, 50, 0.2);
    border: 1px solid rgba(255, 100, 100, 0.4);
    border-radius: 50%;
    color: #ff6666;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.3s;
    z-index: 10;
}

.detail-close-btn:hover {
    background: rgba(255, 50, 50, 0.4);
    transform: rotate(90deg);
}

.detail-header {
    display: flex;
    align-items: center;
    gap: 20px;
    padding: 25px;
    background: linear-gradient(135deg, rgba(0, 100, 150, 0.2) 0%, transparent 100%);
    border-bottom: 1px solid rgba(0, 200, 255, 0.2);
}

.detail-icon-wrap {
    width: 70px;
    height: 70px;
    background: radial-gradient(circle, rgba(0, 150, 255, 0.3) 0%, transparent 70%);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    border: 2px solid rgba(0, 200, 255, 0.3);
    box-shadow: 0 0 20px rgba(0, 150, 255, 0.3);
}

.detail-icon {
    font-size: 40px;
    filter: drop-shadow(0 0 10px currentColor);
}

.detail-title-wrap {
    flex: 1;
}

.detail-name {
    font-family: 'Orbitron', sans-serif;
    font-size: 22px;
    color: #00d4ff;
    margin: 0 0 5px 0;
    text-shadow: 0 0 10px rgba(0, 200, 255, 0.5);
}

.detail-type {
    font-size: 12px;
    color: #888;
    background: rgba(0, 200, 255, 0.1);
    padding: 3px 10px;
    border-radius: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.detail-body {
    padding: 20px 25px;
}

.detail-section {
    margin-bottom: 20px;
}

.detail-section h3 {
    font-family: 'Orbitron', sans-serif;
    font-size: 13px;
    color: #00aaff;
    margin: 0 0 12px 0;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 150, 255, 0.2);
}

.detail-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.detail-item {
    background: rgba(0, 50, 100, 0.2);
    border: 1px solid rgba(0, 150, 255, 0.15);
    border-radius: 8px;
    padding: 10px;
}

.item-label {
    display: block;
    font-size: 10px;
    color: #888;
    margin-bottom: 4px;
    text-transform: uppercase;
}

.item-value {
    display: block;
    font-family: 'Orbitron', monospace;
    font-size: 13px;
    color: #00ff88;
}

.detail-description {
    font-size: 13px;
    line-height: 1.7;
    color: #aaa;
    margin: 0;
    background: rgba(0, 50, 100, 0.15);
    padding: 12px;
    border-radius: 8px;
    border-left: 3px solid rgba(0, 200, 255, 0.4);
}

.detail-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.detail-action-btn {
    flex: 1;
    padding: 12px;
    background: linear-gradient(135deg, rgba(0, 150, 255, 0.2) 0%, rgba(0, 100, 200, 0.1) 100%);
    border: 1px solid rgba(0, 200, 255, 0.4);
    border-radius: 8px;
    color: #00d4ff;
    font-family: 'Orbitron', sans-serif;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.3s;
}

.detail-action-btn:hover {
    background: rgba(0, 200, 255, 0.3);
    box-shadow: 0 0 20px rgba(0, 200, 255, 0.3);
    transform: translateY(-2px);
}

/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
.detail-modal-content::-webkit-scrollbar {
    width: 6px;
}
.detail-modal-content::-webkit-scrollbar-track {
    background: rgba(0, 50, 100, 0.2);
}
.detail-modal-content::-webkit-scrollbar-thumb {
    background: rgba(0, 200, 255, 0.4);
    border-radius: 3px;
}

/* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
@media (max-width: 480px) {
    .detail-modal-content {
        width: 95%;
        max-height: 90vh;
    }
    .detail-header {
        padding: 20px;
    }
    .detail-icon-wrap {
        width: 55px;
        height: 55px;
    }
    .detail-icon {
        font-size: 30px;
    }
    .detail-name {
        font-size: 18px;
    }
    .detail-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<!-- â˜…â˜…â˜… ë¯¸ì…˜ ë³´ë“œ ëª¨ë‹¬ â˜…â˜…â˜… -->
<div id="mission-board-modal" class="voyager-modal">
    <div class="voyager-modal-content wide">
        <div class="voyager-modal-header">
            <div class="modal-title" data-i18n="missionBoard">ğŸ“‹ Mission Board</div>
            <button class="modal-close" id="mission-board-close">âœ•</button>
        </div>
        <div class="voyager-modal-body">
            <div class="mission-tabs">
                <button class="mission-tab active" data-tab="active" data-i18n="missionActive">Active</button>
                <button class="mission-tab" data-tab="available" data-i18n="missionAvailable">Available</button>
                <button class="mission-tab" data-tab="completed" data-i18n="missionCompleted">Completed</button>
            </div>
            <div class="mission-list" id="mission-list">
                <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
            </div>
        </div>
    </div>
</div>

<script src="js/mission.js"></script>

<style>
/* â˜…â˜…â˜… VOYAGER ëª¨ë‹¬ ê³µí†µ ìŠ¤íƒ€ì¼ â˜…â˜…â˜… */
.voyager-modal {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 100000;
    backdrop-filter: blur(5px);
}

.voyager-modal.active {
    display: flex;
}

.voyager-modal-content {
    background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
    border: 2px solid rgba(0, 200, 255, 0.4);
    border-radius: 16px;
    width: 90%;
    max-width: 380px;
    max-height: 80vh;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(0, 200, 255, 0.2);
    animation: modalSlideIn 0.3s ease;
}

.voyager-modal-content.wide {
    max-width: 500px;
}

@keyframes modalSlideIn {
    from { opacity: 0; transform: translateY(-20px) scale(0.95); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}

.voyager-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    background: rgba(0, 0, 0, 0.3);
    border-bottom: 1px solid rgba(0, 200, 255, 0.2);
}

.voyager-modal-header .modal-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 18px;
    color: #00d4ff;
}

.voyager-modal-header .modal-close {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.5);
    font-size: 20px;
    cursor: pointer;
    transition: color 0.2s;
}

.voyager-modal-header .modal-close:hover {
    color: #ff5555;
}

.voyager-modal-body {
    padding: 20px;
    overflow-y: auto;
    max-height: calc(80vh - 60px);
}

/* ì„¤ì • ìŠ¤íƒ€ì¼ */
.settings-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.settings-label {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.9);
}

.settings-control {
    display: flex;
    align-items: center;
    gap: 10px;
}

.settings-control input[type="range"] {
    width: 100px;
    accent-color: #00d4ff;
}

.settings-control select {
    background: rgba(0, 50, 80, 0.8);
    border: 1px solid rgba(0, 200, 255, 0.4);
    color: #fff;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 12px;
}

.settings-control span {
    font-size: 12px;
    color: #00d4ff;
    min-width: 35px;
}

/* í† ê¸€ ìŠ¤ìœ„ì¹˜ */
.toggle-switch {
    position: relative;
    width: 50px;
    height: 26px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(100, 100, 100, 0.5);
    border-radius: 26px;
    transition: 0.3s;
}

.toggle-slider::before {
    content: '';
    position: absolute;
    height: 20px;
    width: 20px;
    left: 3px;
    bottom: 3px;
    background: #fff;
    border-radius: 50%;
    transition: 0.3s;
}

.toggle-switch input:checked + .toggle-slider {
    background: rgba(0, 200, 255, 0.7);
}

.toggle-switch input:checked + .toggle-slider::before {
    transform: translateX(24px);
}

/* ë¯¸ì…˜ ë³´ë“œ ìŠ¤íƒ€ì¼ */
.mission-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
}

.mission-tab {
    flex: 1;
    padding: 10px;
    background: rgba(50, 50, 70, 0.5);
    border: 1px solid rgba(100, 100, 150, 0.3);
    border-radius: 8px;
    color: rgba(255, 255, 255, 0.6);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.mission-tab.active {
    background: rgba(0, 150, 200, 0.4);
    border-color: rgba(0, 200, 255, 0.6);
    color: #fff;
}

.mission-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.mission-card {
    display: flex;
    align-items: center;
    padding: 14px;
    background: linear-gradient(135deg, rgba(30, 50, 70, 0.8) 0%, rgba(40, 60, 80, 0.6) 100%);
    border: 1px solid rgba(0, 200, 255, 0.3);
    border-radius: 10px;
    transition: all 0.2s;
}

.mission-card:hover {
    border-color: rgba(0, 255, 255, 0.6);
    box-shadow: 0 0 15px rgba(0, 200, 255, 0.2);
}

.mission-card.locked {
    opacity: 0.5;
    filter: grayscale(0.5);
}

.mission-icon {
    font-size: 32px;
    margin-right: 14px;
}

.mission-info {
    flex: 1;
}

.mission-name {
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    color: #fff;
    margin-bottom: 4px;
}

.mission-desc {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: 8px;
}

.mission-progress {
    display: flex;
    align-items: center;
    gap: 8px;
}

.progress-bar {
    flex: 1;
    height: 6px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #00d4ff, #00ff88);
    border-radius: 3px;
    transition: width 0.3s;
}

.mission-progress span {
    font-size: 11px;
    color: #00d4ff;
    min-width: 35px;
}

.mission-status {
    font-size: 11px;
    color: rgba(255, 200, 100, 0.8);
}

.mission-reward {
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    color: #ffd700;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}
</style>

<!-- ê´‘ê³  ë³´ìƒ íŒ¨ë„ -->
<div id="ad-rewards-panel" style="
    position: fixed;
    right: 10px;
    top: 15px;
    z-index: 1001;
    display: flex;
    gap: 8px;
    align-items: center;
">
    <button id="ad-menu-toggle" style="
        width: 42px; height: 42px;
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: #fff;
        border: 2px solid #ffaa00;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.3em;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 15px rgba(255, 150, 0, 0.5);
        animation: giftPulse 2s ease-in-out infinite;
    ">ğŸ“‹</button>
</div>
<style>
@keyframes giftPulse {
    0%, 100% { transform: scale(1); box-shadow: 0 0 15px rgba(255, 150, 0, 0.5); }
    50% { transform: scale(1.1); box-shadow: 0 0 25px rgba(255, 150, 0, 0.8); }
}
</style>

<!-- ê´‘ê³  ë³´ìƒ ëª¨ë‹¬ -->
<div id="ad-modal-menu" style="
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 10000;
">
    <div style="
        background: linear-gradient(135deg, #1a1a2e, #16213e);
        border: 2px solid #0ff;
        border-radius: 15px;
        padding: 25px;
        max-width: 350px;
        width: 90%;
        color: white;
        font-family: 'Orbitron', sans-serif;
    ">
        <h3 style="text-align:center; margin:0 0 20px 0; color:#0ff;" data-i18n="adRewardsTitle">ğŸ Ad Rewards</h3>
        
        <!-- ë¶€ìŠ¤í„° -->
        <div id="ad-item-booster" class="ad-reward-item" style="
            background: rgba(0,255,255,0.1);
            border: 1px solid #0ff;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
        ">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size:1.1em;" data-i18n="adBoosterTitle">ğŸš€ 2x Booster</div>
                    <div style="font-size:0.75em; color:#aaa; margin-top:3px;" data-i18n="adBoosterDesc">2x acceleration & max speed (5 min)</div>
                </div>
                <div id="booster-status" style="font-size:0.8em; color:#0f0;"></div>
            </div>
            <button id="ad-booster-btn" style="
                width: 100%;
                margin-top: 8px;
                padding: 8px;
                background: linear-gradient(135deg, #0a84ff, #0066cc);
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 0.85em;
            " data-i18n="watchAd">ğŸ“º Watch Ad</button>
        </div>
        
        <!-- ê¸´ê¸‰íƒˆì¶œ -->
        <div id="ad-item-escape" class="ad-reward-item" style="
            background: rgba(255,153,0,0.1);
            border: 1px solid #f90;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
        ">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size:1.1em;" data-i18n="adEscapeTitle">âš¡ Emergency Escape</div>
                    <div style="font-size:0.75em; color:#aaa; margin-top:3px;" data-i18n="adEscapeDesc">Free emergency escape x1 (10 min)</div>
                </div>
                <div id="escape-status" style="font-size:0.8em; color:#0f0;"></div>
            </div>
            <button id="ad-escape-btn" style="
                width: 100%;
                margin-top: 8px;
                padding: 8px;
                background: linear-gradient(135deg, #f39c12, #d68910);
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 0.85em;
            " data-i18n="watchAd">ğŸ“º Watch Ad</button>
        </div>
        
        <!-- ë‘˜ëŸ¬ë³´ê¸° (ë©€í‹° ì „ìš©) -->
        <div id="ad-item-explore" class="ad-reward-item" style="
            background: rgba(155,89,182,0.1);
            border: 1px solid #9b59b6;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            display: none;
        ">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size:1.1em;" data-i18n="adExploreTitle">ğŸ”­ Explore Mode</div>
                    <div style="font-size:0.75em; color:#aaa; margin-top:3px;" data-i18n="adExploreDesc">Free camera exploration (3 min, stackable)</div>
                </div>
                <div id="explore-status" style="font-size:0.8em; color:#0f0;"></div>
            </div>
            <button id="ad-explore-btn" style="
                width: 100%;
                margin-top: 8px;
                padding: 8px;
                background: linear-gradient(135deg, #9b59b6, #8e44ad);
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 0.85em;
            " data-i18n="watchAd">ğŸ“º Watch Ad</button>
        </div>
        
        <button id="ad-modal-close" style="
            width: 100%;
            padding: 10px;
            background: #555;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
        " data-i18n="close">ë‹«ê¸°</button>
    </div>
</div>

<!-- SSIL í›ˆë ¨ ë¯¸ì…˜ íŒ¨ë„ -->
<div id="ssil-mission-panel">
    <button class="mission-close-btn" onclick="closeMissionPanel()">âœ•</button>
    <div class="ssil-logo">ğŸš€</div>
    <h2 data-i18n="ssilTrainingProgram">SSIL í›ˆë ¨ í”„ë¡œê·¸ë¨</h2>
    <div class="ssil-subtitle" data-i18n="ssilSubtitle">Solar System Integrated Logistics</div>
    
    <table class="mission-table" id="training-mission-table">
        <thead>
            <tr>
                <th class="mission-status">âœ“</th>
                <th data-i18n="mission">ë¯¸ì…˜</th>
                <th data-i18n="missionDesc">ì„¤ëª…</th>
                <th class="mission-reward" data-i18n="reward">ë³´ìƒ</th>
            </tr>
        </thead>
        <tbody id="training-mission-body">
            <!-- JavaScriptë¡œ ì±„ì›Œì§ -->
        </tbody>
    </table>
    
    <div style="text-align:center; margin-top:20px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.1);">
        <div style="color:#888; font-size:0.7em;" data-i18n="totalReward">ì´ ë³´ìƒ</div>
        <div style="color:#ffd700; font-size:1.2em;" id="total-training-reward">0 ì½”ì¸</div>
    </div>
</div>

<!-- ì¼ì¼ ë¯¸ì…˜ ì´ë©”ì¼ ì•„ì´ì½˜ -->
<div id="daily-mission-icon" onclick="openDailyMission()">
    ğŸ“§
    <span class="badge" id="daily-mission-badge">1</span>
</div>

<!-- ë¯¸ì…˜ í¬ì¸íŠ¸ í‘œì‹œ -->
<div id="mission-points-display">
    â­ <span id="mission-points-value">0</span> MP
</div>

<!-- ì¼ì¼ ë¯¸ì…˜ ëª¨ë‹¬ -->
<div id="daily-mission-modal">
    <div class="daily-mission-content">
        <div class="daily-mission-header">
            <span class="icon">ğŸ“§</span>
            <div>
                <h3 data-i18n="ssilWorkOrder">SSIL ì—…ë¬´ ì§€ì‹œì„œ</h3>
                <div style="font-size:0.7em; color:#888;" data-i18n="urgentDelivery">ê¸´ê¸‰ ë°°ë‹¬ ìš”ì²­</div>
            </div>
            <span class="date" id="daily-mission-date">12/15</span>
        </div>
        
        <div class="daily-mission-body" id="daily-mission-desc">
            í™”ì„± ì •ê±°ì¥ìœ¼ë¡œ ê¸´ê¸‰ ë¬¼ìë¥¼ ë°°ë‹¬í•´ ì£¼ì„¸ìš”.
            ì œí•œ ì‹œê°„ ë‚´ ë„ì°© ì‹œ ì¶”ê°€ ë³´ë„ˆìŠ¤ê°€ ì§€ê¸‰ë©ë‹ˆë‹¤.
        </div>
        
        <div class="daily-mission-rewards">
            <div class="daily-reward-item">
                <div class="value" id="daily-reward-coins">300</div>
                <div class="label" data-i18n="coins">ì½”ì¸</div>
            </div>
            <div class="daily-reward-item">
                <div class="value" id="daily-reward-points">+1</div>
                <div class="label">MP</div>
            </div>
        </div>
        
        <div class="daily-mission-btns">
            <button class="daily-btn-accept" onclick="acceptDailyMission()" data-i18n="accept">âœ“ ìˆ˜ë½</button>
            <button class="daily-btn-decline" onclick="closeDailyMission()" data-i18n="later">ë‚˜ì¤‘ì—</button>
        </div>
    </div>
</div>

<!-- ì¤‘ë ¥ ê²½ê³  HUD -->
<div id="gravity-hud-warning" style="
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(200, 0, 0, 0.85);
    border: 3px solid #ff0000;
    border-radius: 15px;
    padding: 20px 30px;
    color: white;
    font-family: 'Orbitron', monospace;
    z-index: 9999;
    display: none;
    text-align: center;
    animation: gravityPulse 0.5s ease-in-out infinite alternate;
">
    <div style="font-size: 1.5em; margin-bottom: 10px;" data-i18n="gravityCapture">ğŸš¨ ì¤‘ë ¥ ìœ„í—˜!</div>
    <div id="gravity-body-name" style="font-size: 1.1em; color: #ff0;"></div>
    <div style="margin: 15px 0; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 15px;">
        <div>âš¡ <span data-i18n="escapeVelocity">í•„ìš” ì†ë„</span>: <span id="gravity-escape-vel" style="color: #0ff;">0</span> km/s</div>
        <div>ğŸ“Š <span data-i18n="currentVelocity">í˜„ì¬ ì†ë„</span>: <span id="gravity-current-vel" style="color: #0f0;">0</span> km/s</div>
        <div>ğŸ“‰ <span data-i18n="deficit">ë¶€ì¡±</span>: <span id="gravity-deficit" style="color: #f90;">0</span> km/s</div>
    </div>
    <div style="margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px;">
        ğŸ”„ <span id="gravity-turn-dir" data-i18n="turnLeft">ì¢Œì¸¡</span><span data-i18n="gravityWarning">ìœ¼ë¡œ</span> <span id="gravity-turn-angle">0</span>Â° <span data-i18n="avoidText">íšŒí”¼</span>
    </div>
</div>
<style>
@keyframes gravityPulse {
    from { box-shadow: 0 0 20px rgba(255,0,0,0.5); }
    to { box-shadow: 0 0 40px rgba(255,0,0,0.9); }
}
/* ì‚¬ìš´ë“œ ìŠ¬ë¼ì´ë“œ íŒ¨ë„ */
#sound-slide {
    position: fixed;
    left: 0;
    bottom: 140px;
    z-index: 1001;
    display: flex;
    align-items: center;
}
#sound-slide-panel {
    background: rgba(0,0,0,0.9);
    border: 1px solid #0ff;
    border-radius: 0 8px 8px 0;
    padding: 6px 8px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s ease;
    overflow: hidden;
}
#sound-slide.collapsed #sound-slide-panel {
    width: 0;
    padding: 6px 0;
    border: none;
    opacity: 0;
}
#sound-slide.expanded #sound-slide-panel {
    width: auto;
    opacity: 1;
}
#sound-onoff {
    background: #222;
    border: 1px solid #555;
    color: #666;
    width: 26px; height: 26px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85em;
    display: flex;
    align-items: center;
    justify-content: center;
}
#sound-onoff.on { 
    background: #0a4; 
    border-color: #0f0; 
    color: #fff;
    box-shadow: 0 0 8px #0f0;
}
#sound-slider { width: 50px; cursor: pointer; }
#sound-val { color: #aaa; font-size: 0.6em; min-width: 26px; text-align: right; }
#sound-arrow {
    background: rgba(0,0,0,0.9);
    border: 1px solid #0ff;
    width: 22px; height: 34px;
    cursor: pointer;
    color: #0ff;
    border-radius: 0 6px 6px 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75em;
    flex-shrink: 0;
}
#sound-arrow:hover { background: rgba(0,255,255,0.1); }
/* ê¸´ê¸‰íƒˆì¶œ ì¶©ì „ í‘œì‹œ */
@keyframes escapeFlash {
    from { background: rgba(255,153,0,0.2); box-shadow: none; }
    to { background: rgba(255,153,0,0.6); box-shadow: 0 0 15px #f90; }
}
</style>

<!-- ì‚¬ìš´ë“œ ìŠ¬ë¼ì´ë“œ íŒ¨ë„ -->
<div id="sound-slide" class="collapsed">
    <div id="sound-slide-panel">
        <button id="sound-onoff" title="ì†Œë¦¬ ì¼œê¸°/ë„ê¸°" data-i18n-title="soundOnOff">ğŸ”‡</button>
        <input type="range" id="sound-slider" min="0" max="100" value="40">
        <span id="sound-val">40%</span>
    </div>
    <div id="sound-arrow">â—€</div>
</div>

<!-- ë§ì›ê²½ ëª¨ë“œ ì˜¤ë²„ë ˆì´ -->
<div id="telescope-overlay" style="
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9000;
    pointer-events: none;
    background: radial-gradient(circle at center, transparent 30%, rgba(0,0,0,0.95) 60%);
">
    <!-- ë§ì›ê²½ ë Œì¦ˆ í”„ë ˆì„ (ì›í˜• ë¹„ë„¤íŒ…) -->
    <div id="telescope-lens" style="
        position: absolute;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, 
            transparent 0%, 
            transparent 25%, 
            rgba(0,0,0,0.3) 35%, 
            rgba(0,0,0,0.7) 45%, 
            rgba(0,0,0,0.95) 55%);
        pointer-events: none;
    "></div>
    
    <!-- ì‹­ìì„  ë ˆí‹°í´ -->
    <div id="telescope-reticle" style="
        width: 300px; height: 300px;
        border: 2px solid rgba(255,100,100,0.6);
        border-radius: 50%;
        position: relative;
        box-shadow: 0 0 30px rgba(255,100,100,0.3), inset 0 0 50px rgba(0,0,0,0.5);
    ">
        <div style="position:absolute;top:50%;left:0;right:0;height:1px;background:rgba(255,100,100,0.5);"></div>
        <div style="position:absolute;left:50%;top:0;bottom:0;width:1px;background:rgba(255,100,100,0.5);"></div>
        <!-- ëˆˆê¸ˆì„  -->
        <div style="position:absolute;top:50%;left:10%;width:15%;height:1px;background:rgba(255,100,100,0.3);"></div>
        <div style="position:absolute;top:50%;right:10%;width:15%;height:1px;background:rgba(255,100,100,0.3);"></div>
        <div style="position:absolute;left:50%;top:10%;height:15%;width:1px;background:rgba(255,100,100,0.3);"></div>
        <div style="position:absolute;left:50%;bottom:10%;height:15%;width:1px;background:rgba(255,100,100,0.3);"></div>
        <!-- ì¤‘ì•™ ì  -->
        <div style="position:absolute;top:50%;left:50%;width:6px;height:6px;background:#ff6666;border-radius:50%;transform:translate(-50%,-50%);"></div>
    </div>
    
    <!-- ìƒë‹¨ ì •ë³´ íŒ¨ë„ -->
    <div id="telescope-info-panel" style="
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,20,40,0.9);
        padding: 15px 30px;
        border-radius: 10px;
        border: 1px solid #00aaff;
        color: #00ffff;
        font-family: 'Orbitron', monospace;
        text-align: center;
        pointer-events: auto;
    ">
        <div style="font-size: 18px; margin-bottom: 8px;" data-i18n="telescopeMode">ğŸ”­ ë§ì›ê²½ ëª¨ë“œ</div>
        <div style="display: flex; gap: 30px; font-size: 14px;">
            <span><span data-i18n="zoomLabel">ì¤Œ</span>: <strong id="telescope-zoom-display">1.0</strong>x</span>
            <span><span data-i18n="maxZoomLabel">ìµœëŒ€</span>: <strong id="telescope-max-zoom-display">20</strong>x</span>
            <span id="telescope-target-info" data-i18n="targetNone">íƒ€ê²Ÿ: ì—†ìŒ</span>
        </div>
    </div>
    
    <!-- ìš°ì¸¡ ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
    <div id="telescope-control-panel" style="
        position: absolute;
        right: 30px;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0,20,40,0.95);
        border: 2px solid #00aaff;
        border-radius: 15px;
        padding: 20px;
        pointer-events: auto;
        min-width: 180px;
    ">
        <div style="color:#00ffff;text-align:center;margin-bottom:15px;font-size:16px;font-weight:bold;">ğŸšï¸ <span data-i18n="zoomLabel">ì¤Œ</span></div>
        
        <!-- ì¤Œ í”„ë¦¬ì…‹ ë²„íŠ¼ -->
        <div id="telescope-zoom-presets" style="display:flex;flex-direction:column;gap:8px;margin-bottom:15px;">
            <button class="telescope-preset-btn" data-zoom="1" style="padding:8px;background:#1a3a5c;color:#fff;border:1px solid #00aaff;border-radius:5px;cursor:pointer;">1x</button>
            <button class="telescope-preset-btn" data-zoom="5" style="padding:8px;background:#1a3a5c;color:#fff;border:1px solid #00aaff;border-radius:5px;cursor:pointer;">5x</button>
            <button class="telescope-preset-btn" data-zoom="10" style="padding:8px;background:#1a3a5c;color:#fff;border:1px solid #00aaff;border-radius:5px;cursor:pointer;">10x</button>
            <button class="telescope-preset-btn" data-zoom="20" style="padding:8px;background:#1a3a5c;color:#fff;border:1px solid #00aaff;border-radius:5px;cursor:pointer;">20x</button>
            <button class="telescope-preset-btn locked" data-zoom="30" style="padding:8px;background:#333;color:#888;border:1px solid #555;border-radius:5px;cursor:not-allowed;">ğŸ”’ 30x</button>
            <button class="telescope-preset-btn locked" data-zoom="50" style="padding:8px;background:#333;color:#888;border:1px solid #555;border-radius:5px;cursor:not-allowed;">ğŸ”’ 50x</button>
            <button class="telescope-preset-btn locked" data-zoom="100" style="padding:8px;background:#333;color:#888;border:1px solid #555;border-radius:5px;cursor:not-allowed;">ğŸ”’ 100x</button>
        </div>
        
        <!-- ìŠ¬ë¼ì´ë” -->
        <div style="margin-bottom:15px;">
            <input type="range" id="telescope-zoom-slider" 
                min="1" max="20" value="1" step="0.5"
                style="width:100%;accent-color:#00aaff;">
            <div id="telescope-zoom-value" style="color:#fff;text-align:center;margin-top:5px;font-size:20px;font-weight:bold;">1.0x</div>
        </div>
        
        <!-- ì¥ì°©ëœ ë§ì›ê²½ ì •ë³´ -->
        <div id="telescope-equipped-info" style="
            background: rgba(0,50,100,0.5);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 12px;
            color: #aaddff;
        ">
            <div style="font-weight:bold;margin-bottom:5px;">ğŸ“¡ <span data-i18n="telescope">ë§ì›ê²½</span></div>
            <div id="telescope-equipped-name" data-i18n="defaultTelescope">ê¸°ë³¸ ë§ì›ê²½ (20x)</div>
        </div>
        
        <!-- ë‹«ê¸° ë²„íŠ¼ -->
        <button id="btn-telescope-close" style="
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #c0392b, #e74c3c);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        " data-i18n="telescopeExit">âœ• ë§ì›ê²½ ì¢…ë£Œ</button>
    </div>
    
    <!-- ì¢Œì¸¡ í•˜ë‹¨ - ì¡°ì‘ ì•ˆë‚´ -->
    <div style="
        position: absolute;
        bottom: 30px;
        left: 30px;
        background: rgba(0,20,40,0.8);
        padding: 15px;
        border-radius: 10px;
        color: #88ccff;
        font-size: 12px;
        pointer-events: none;
    ">
        <div style="font-weight:bold;margin-bottom:8px;">ğŸ“– ì¡°ì‘ë²•</div>
        <div data-i18n="mouseDrag">ğŸ–±ï¸ ë§ˆìš°ìŠ¤ ë“œë˜ê·¸: ì‹œì  ì´ë™</div>
        <div data-i18n="wheelZoom">ğŸ”„ íœ  ìŠ¤í¬ë¡¤: ì¤Œ ì¡°ì ˆ</div>
        <div data-i18n="escExit">ESC: ë§ì›ê²½ ì¢…ë£Œ</div>
    </div>
</div>

    <div id="top-bar">
        <!-- ë¡œê³  ì œê±°ë¨ -->
        <div class="control-group" style="margin-left: 10px;">
            <select id="lang-select" class="mode-btn" style="padding:5px 8px; cursor:pointer; font-size:11px;">
                <option value="en" selected>ğŸ‡ºğŸ‡¸ English</option>
                <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                <option value="la">ğŸ›ï¸ Latina</option>
            </select>
            <button id="btn-scale-mode" class="mode-btn" data-i18n="distExp" style="font-size:11px; padding:6px 12px;">Dist: Experience</button>
            <button id="btn-reset-solar" class="mode-btn" data-i18n="resetSolarSystem" style="background: linear-gradient(135deg, #ff6b35, #f7931e); border-color: #ff8c00; font-size:11px; padding:6px 12px;">ğŸ”„ íƒœì–‘ê³„ ì´ˆê¸°í™”</button>
            <button id="btn-station" class="mode-btn" data-i18n="station" style="font-size:11px; padding:6px 12px;">ğŸ›°ï¸ ì •ê±°ì¥</button>
            <button id="btn-catalog" class="mode-btn" data-i18n="catalog" style="font-size:11px; padding:6px 12px;">ğŸ“– Catalog</button>
            <button id="btn-fullscreen" class="mode-btn" data-i18n="fullscreen" style="font-size:11px; padding:6px 12px;">â›¶ Fullscreen</button>
            <!-- ëª¨ë°”ì¼ìš© ì‹œê°„ ë°°ì† ë²„íŠ¼ -->
            <div id="mobile-time-controls">
                <button id="time-slower" class="time-btn">âª</button>
                <span id="time-val-mobile">0.1x</span>
                <button id="time-faster" class="time-btn">â©</button>
            </div>
            <!-- ë°ìŠ¤í¬í†±ìš© ìŠ¬ë¼ì´ë” -->
            <div class="slider-container">
                <div class="slider-row">
                    <span class="slider-label" data-i18n="fine">ì •ë°€(0~2x)</span>
                    <input type="range" id="time-slider-fine" min="0" max="2" step="0.1" value="0.1">
                </div>
                <div class="slider-row">
                    <span class="slider-label" data-i18n="fast">ê³ ì†(1~100x)</span>
                    <input type="range" id="time-slider-coarse" min="1" max="100" step="1" value="1">
                </div>
            </div>
            <div id="time-val">0.1x</div>
        </div>
        <!-- ìœ ì € ì •ë³´ ì˜ì—­ -->
        <div id="user-area">
            <!-- â˜…â˜…â˜… ë©€í‹°ëª¨ë“œ ì‚¬ìš©ì í”„ë¡œí•„ (ë¡œê·¸ì¸ í›„ í‘œì‹œ) â˜…â˜…â˜… -->
            <div id="user-profile-panel" style="display:none;">
                <div class="profile-avatar" id="profile-avatar">ğŸ‘¤</div>
                <div class="profile-info">
                    <div class="profile-name" id="profile-name">User</div>
                    <div class="profile-stats">
                        <span class="stat-item coins">ğŸª™ <span id="profile-coins">0</span></span>
                        <span class="stat-item level">â­ Lv.<span id="profile-level">1</span></span>
                    </div>
                    <div class="profile-exp-bar">
                        <div class="exp-fill" id="profile-exp-fill" style="width: 0%"></div>
                    </div>
                </div>
                <button class="profile-menu-btn" id="profile-menu-btn">â–¼</button>
            </div>
            
            <!-- í”„ë¡œí•„ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ -->
            <div id="profile-dropdown" style="display:none;">
                <div class="dropdown-item" id="dropdown-profile" data-i18n="myProfile">ğŸ‘¤ My Profile</div>
                <div class="dropdown-item" id="dropdown-missions" data-i18n="dropdownMissions">ğŸ“‹ Mission Board</div>
                <div class="dropdown-item" id="dropdown-settings" data-i18n="dropdownSettings">âš™ï¸ Settings</div>
                <div class="dropdown-item logout" id="dropdown-logout" data-i18n="dropdownLogout">ğŸšª Logout</div>
            </div>

            <!-- â˜…â˜…â˜… í”„ë¡œí•„ í¸ì§‘ ëª¨ë‹¬ â˜…â˜…â˜… -->
            <div id="profile-edit-modal" class="profile-modal-overlay">
                <div class="profile-modal">
                    <button class="profile-modal-close" onclick="closeProfileModal()">âœ•</button>
                    <h3>ğŸ‘¤ ë‚´ í”„ë¡œí•„</h3>

                    <div class="profile-modal-avatar">
                        <div id="modal-avatar">ğŸ‘¤</div>
                    </div>

                    <div class="profile-modal-section">
                        <label>ë‹‰ë„¤ì„</label>
                        <div class="profile-input-group">
                            <input type="text" id="profile-nickname-input" maxlength="20" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
                            <button id="save-nickname-btn" onclick="saveNickname()">ì €ì¥</button>
                        </div>
                        <div class="profile-input-hint">2~20ì, íŠ¹ìˆ˜ë¬¸ì ì œì™¸</div>
                    </div>

                    <div class="profile-modal-section">
                        <label>ì´ë©”ì¼</label>
                        <div class="profile-readonly" id="modal-email">-</div>
                    </div>

                    <div class="profile-modal-section">
                        <label>ê°€ì…ì¼</label>
                        <div class="profile-readonly" id="modal-created-at">-</div>
                    </div>

                    <div class="profile-modal-stats">
                        <div class="modal-stat">
                            <span class="modal-stat-value" id="modal-coins">0</span>
                            <span class="modal-stat-label">ğŸª™ ì½”ì¸</span>
                        </div>
                        <div class="modal-stat">
                            <span class="modal-stat-value" id="modal-level">1</span>
                            <span class="modal-stat-label">â­ ë ˆë²¨</span>
                        </div>
                        <div class="modal-stat">
                            <span class="modal-stat-value" id="modal-exp">0</span>
                            <span class="modal-stat-label">âœ¨ ê²½í—˜ì¹˜</span>
                        </div>
                    </div>

                    <div id="profile-save-status"></div>
                </div>
            </div>
            
            <div id="user-coins" style="display:none;">ğŸª™ <span id="coin-amount">0</span></div>
            <div id="user-info" style="display:none;">
                <span id="user-name">Guest</span>
                <button id="btn-logout" class="mode-btn" data-i18n="logout" onclick="confirmLogout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
            <button id="btn-login" class="mode-btn" data-i18n="login" onclick="openAuthUI()">ğŸ” ë¡œê·¸ì¸</button>
        </div>
    </div>
    
    <style>
    /* â˜…â˜…â˜… ì‚¬ìš©ì í”„ë¡œí•„ íŒ¨ë„ ìŠ¤íƒ€ì¼ (ë©€í‹°ëª¨ë“œìš©) â˜…â˜…â˜… */
    #user-profile-panel {
        position: fixed;
        top: 10px;
        right: 10px;  /* ê°€ì¥ ì˜¤ë¥¸ìª½ */
        display: flex;
        align-items: center;
        gap: 10px;
        background: linear-gradient(135deg, rgba(0, 40, 80, 0.95) 0%, rgba(0, 20, 50, 0.98) 100%);
        border: 2px solid rgba(0, 200, 255, 0.4);
        border-radius: 12px;
        padding: 8px 12px;
        cursor: pointer;
        transition: all 0.3s;
        z-index: 1001;
    }
    
    #user-profile-panel:hover {
        border-color: rgba(0, 255, 255, 0.7);
        box-shadow: 0 0 15px rgba(0, 200, 255, 0.3);
    }
    
    .profile-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #1a5276, #2980b9);
        border: 2px solid #00d4ff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        overflow: hidden;
    }
    
    .profile-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .profile-info {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }
    
    .profile-name {
        font-family: 'Orbitron', sans-serif;
        font-size: 12px;
        color: #fff;
        font-weight: 600;
    }
    
    .profile-stats {
        display: flex;
        gap: 10px;
        font-size: 10px;
    }
    
    .stat-item.coins { color: #ffd700; }
    .stat-item.level { color: #00ff88; }
    
    .profile-exp-bar {
        width: 80px;
        height: 4px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 2px;
        overflow: hidden;
    }
    
    .exp-fill {
        height: 100%;
        background: linear-gradient(90deg, #00d4ff, #00ff88);
        transition: width 0.3s;
    }
    
    .profile-menu-btn {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.5);
        font-size: 10px;
        cursor: pointer;
        padding: 5px;
        transition: color 0.2s;
    }
    
    .profile-menu-btn:hover {
        color: #00d4ff;
    }
    
    /* í”„ë¡œí•„ ë“œë¡­ë‹¤ìš´ */
    #profile-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 5px;
        background: linear-gradient(135deg, rgba(10, 30, 50, 0.98) 0%, rgba(5, 15, 30, 0.98) 100%);
        border: 2px solid rgba(0, 200, 255, 0.4);
        border-radius: 10px;
        overflow: hidden;
        min-width: 150px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        z-index: 1001;
    }
    
    .dropdown-item {
        padding: 12px 15px;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.8);
        cursor: pointer;
        transition: all 0.2s;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .dropdown-item:last-child {
        border-bottom: none;
    }
    
    .dropdown-item:hover {
        background: rgba(0, 200, 255, 0.2);
        color: #fff;
    }
    
    .dropdown-item.logout:hover {
        background: rgba(255, 50, 50, 0.3);
        color: #ff6666;
    }

    /* â˜…â˜…â˜… í”„ë¡œí•„ í¸ì§‘ ëª¨ë‹¬ â˜…â˜…â˜… */
    .profile-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10002;
    }
    .profile-modal-overlay.active {
        display: flex;
    }
    .profile-modal {
        background: linear-gradient(135deg, rgba(10, 30, 60, 0.98) 0%, rgba(5, 15, 40, 0.98) 100%);
        border: 2px solid #0ff;
        border-radius: 15px;
        padding: 20px;
        width: 320px;
        max-width: 95vw;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
        box-shadow: 0 0 40px rgba(0, 255, 255, 0.3);
    }
    .profile-modal h3 {
        color: #0ff;
        text-align: center;
        margin: 0 0 15px 0;
        font-family: 'Orbitron', sans-serif;
        font-size: 16px;
    }
    .profile-modal-close {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s;
    }
    .profile-modal-close:hover {
        opacity: 1;
    }
    .profile-modal-avatar {
        text-align: center;
        margin-bottom: 15px;
    }
    .profile-modal-avatar > div {
        width: 70px;
        height: 70px;
        margin: 0 auto;
        border-radius: 50%;
        background: linear-gradient(135deg, #1a5276, #2980b9);
        border: 3px solid #0ff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 35px;
        overflow: hidden;
    }
    .profile-modal-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .profile-modal-section {
        margin-bottom: 12px;
    }
    .profile-modal-section label {
        display: block;
        color: #8cf;
        font-size: 11px;
        margin-bottom: 5px;
    }
    .profile-input-group {
        display: flex;
        gap: 8px;
    }
    .profile-input-group input {
        flex: 1;
        background: rgba(0, 40, 80, 0.6);
        border: 1px solid rgba(0, 255, 255, 0.4);
        border-radius: 6px;
        padding: 8px 10px;
        color: #fff;
        font-size: 13px;
        outline: none;
    }
    .profile-input-group input:focus {
        border-color: #0ff;
        box-shadow: 0 0 8px rgba(0, 255, 255, 0.3);
    }
    .profile-input-group button {
        background: linear-gradient(135deg, #27ae60, #2ecc71);
        border: none;
        border-radius: 6px;
        padding: 8px 15px;
        color: #fff;
        font-size: 12px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .profile-input-group button:hover {
        transform: scale(1.05);
        box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
    }
    .profile-input-group button:disabled {
        background: #555;
        cursor: not-allowed;
        transform: none;
    }
    .profile-input-hint {
        color: #68a;
        font-size: 10px;
        margin-top: 4px;
    }
    .profile-readonly {
        background: rgba(0, 20, 40, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 6px;
        padding: 8px 10px;
        color: rgba(255, 255, 255, 0.6);
        font-size: 12px;
    }
    .profile-modal-stats {
        display: flex;
        justify-content: space-around;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid rgba(0, 255, 255, 0.2);
    }
    .modal-stat {
        text-align: center;
    }
    .modal-stat-value {
        display: block;
        font-size: 20px;
        font-weight: bold;
        color: #fff;
        font-family: 'Orbitron', sans-serif;
    }
    .modal-stat-label {
        display: block;
        font-size: 10px;
        color: #8cf;
        margin-top: 3px;
    }
    #profile-save-status {
        text-align: center;
        font-size: 12px;
        margin-top: 10px;
        min-height: 18px;
    }
    #profile-save-status.success { color: #2ecc71; }
    #profile-save-status.error { color: #e74c3c; }

    /* ëª¨ë°”ì¼ ìµœì í™” */
    @media (max-width: 768px) {
        #user-profile-panel {
            padding: 6px 8px;
            gap: 6px;
        }
        
        .profile-avatar {
            width: 32px;
            height: 32px;
            font-size: 16px;
        }
        
        .profile-name {
            font-size: 10px;
        }
        
        .profile-stats {
            font-size: 9px;
            gap: 6px;
        }
        
        .profile-exp-bar {
            width: 60px;
        }
    }
    </style>

    <div id="nav-container">
        <div id="nav-panel">
            <div class="nav-header" data-i18n="bodyList">ì²œì²´ ëª©ë¡</div>
            <div id="nav-list"></div>
        </div>
        <div id="nav-toggle">â—€</div>
    </div>

    <div id="spawn-dock"></div>
    
    <div id="catalog-modal">
        <h2 style="color:white; margin-bottom:15px;" id="catalog-title" data-i18n="catalogTitle">ğŸŒŒ ì²œì²´ ë„ê° (í´ë¦­í•˜ì—¬ ìƒì„±)</h2>
        <div id="catalog-content"></div>
        <button id="catalog-close" data-i18n="close">ë‹«ê¸°</button>
    </div>
    
    <!-- ì²œì²´ ì •ë³´ ëª¨ë‹¬ (ë©€í‹°ëª¨ë“œìš©) - SF ë””ìì¸ -->
    <div id="body-info-modal" style="
        display: none;
        position: fixed;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(5, 15, 30, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 200, 255, 0.3);
        border-radius: 20px;
        padding: 0;
        z-index: 10000;
        min-width: 360px;
        max-width: 90vw;
        max-height: 85vh;
        overflow: hidden;
        color: white;
        font-family: 'Orbitron', 'Rajdhani', sans-serif;
        box-shadow: 
            0 0 60px rgba(0, 150, 255, 0.3),
            inset 0 0 60px rgba(0, 100, 200, 0.05),
            0 25px 50px rgba(0, 0, 0, 0.5);
    ">
        <!-- í—¤ë” ë°” -->
        <div style="
            background: linear-gradient(90deg, rgba(0,100,150,0.8), rgba(0,50,100,0.4));
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 200, 255, 0.2);
        ">
            <h3 id="body-info-name" style="color:#00d4ff; margin:0; font-size: 1.4em; text-shadow: 0 0 20px rgba(0,200,255,0.5);"></h3>
            <button id="body-info-close" style="
                background: rgba(255,100,100,0.2);
                border: 1px solid rgba(255,100,100,0.5);
                color: #ff6b6b;
                width: 32px;
                height: 32px;
                border-radius: 50%;
                cursor: pointer;
                font-size: 1.1em;
                transition: all 0.3s;
            " onmouseover="this.style.background='rgba(255,100,100,0.4)'" onmouseout="this.style.background='rgba(255,100,100,0.2)'">âœ•</button>
        </div>
        
        <!-- ìŠ¤í¬ë¡¤ ì»¨í…ì¸  -->
        <div style="padding: 20px; overflow-y: auto; max-height: calc(85vh - 140px);">
            
            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div style="
                background: linear-gradient(135deg, rgba(0,80,120,0.3), rgba(0,40,80,0.2));
                border: 1px solid rgba(0,180,255,0.2);
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                position: relative;
                overflow: hidden;
            ">
                <div style="
                    position: absolute;
                    top: 0; left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(180deg, #00d4ff, #0088ff);
                "></div>
                <div style="color:#00d4ff; font-size: 0.8em; margin-bottom: 12px; letter-spacing: 2px; text-transform: uppercase;">
                    <span style="opacity: 0.7;">â–¸</span> <span data-i18n="infoBasicInfo">ê¸°ë³¸ ì •ë³´</span>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="infoType">ìœ í˜•</span> <span id="info-type" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="bodyRadius">ë°˜ì§€ë¦„</span> <span id="info-radius" style="color:#fff;"></span><span style="color:#6aa;font-size:0.8em;">km</span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="bodyMass">ì§ˆëŸ‰</span> <span id="info-mass" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="infoOrbit">ê³µì „</span> <span id="info-orbit" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="infoGravity">ì¤‘ë ¥</span> <span id="info-gravity" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#6aa;" data-i18n="infoTemp">ê¸°ì˜¨</span> <span id="info-temp" style="color:#fff;"></span></div>
                </div>
            </div>
            
            <!-- í…Œë¼í¬ë° ìƒíƒœ -->
            <div style="
                background: linear-gradient(135deg, rgba(0,100,60,0.3), rgba(0,60,40,0.2));
                border: 1px solid rgba(0,255,150,0.2);
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                position: relative;
                overflow: hidden;
            ">
                <div style="
                    position: absolute;
                    top: 0; left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(180deg, #00ff88, #00aa55);
                "></div>
                <div style="color:#00ff88; font-size: 0.8em; margin-bottom: 12px; letter-spacing: 2px; text-transform: uppercase;">
                    <span style="opacity: 0.7;">â–¸</span> <span data-i18n="terraformingStatus">í…Œë¼í¬ë° ìƒíƒœ</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                    <div style="flex: 1; height: 10px; background: rgba(0,0,0,0.5); border-radius: 5px; overflow: hidden; border: 1px solid rgba(0,255,150,0.3);">
                        <div id="info-terraform-bar" style="height: 100%; background: linear-gradient(90deg, #ff4444, #ffaa00, #00ff88); width: 0%; transition: width 0.5s; box-shadow: 0 0 10px rgba(0,255,150,0.5);"></div>
                    </div>
                    <span id="info-terraform-percent" style="font-size: 1em; color: #00ff88; font-weight: bold; min-width: 45px; text-align: right;">0%</span>
                </div>
                <div id="info-terraform-status" style="font-size: 0.8em; color: #8ca;"></div>
            </div>
            
            <!-- ì¸í”„ë¼ -->
            <div style="
                background: linear-gradient(135deg, rgba(120,80,0,0.3), rgba(80,50,0,0.2));
                border: 1px solid rgba(255,180,0,0.2);
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                position: relative;
                overflow: hidden;
            ">
                <div style="
                    position: absolute;
                    top: 0; left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(180deg, #ffaa00, #ff6600);
                "></div>
                <div style="color:#ffaa00; font-size: 0.8em; margin-bottom: 12px; letter-spacing: 2px; text-transform: uppercase;">
                    <span style="opacity: 0.7;">â–¸</span> <span data-i18n="infrastructure">ì¸í”„ë¼</span>
                </div>
                <div id="info-infrastructure" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85em;"></div>
            </div>
            
            <!-- ìì› -->
            <div style="
                background: linear-gradient(135deg, rgba(100,0,100,0.3), rgba(60,0,80,0.2));
                border: 1px solid rgba(255,100,255,0.2);
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                position: relative;
                overflow: hidden;
            ">
                <div style="
                    position: absolute;
                    top: 0; left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(180deg, #ff66ff, #aa44aa);
                "></div>
                <div style="color:#ff66ff; font-size: 0.8em; margin-bottom: 12px; letter-spacing: 2px; text-transform: uppercase;">
                    <span style="opacity: 0.7;">â–¸</span> ì±„ì·¨ ê°€ëŠ¥ ìì›
                </div>
                <div id="info-resources" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
            </div>
            
            <!-- ì‹ë¯¼ì§€ ì •ë³´ -->
            <div style="
                background: linear-gradient(135deg, rgba(60,60,120,0.3), rgba(40,40,80,0.2));
                border: 1px solid rgba(150,150,255,0.2);
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                position: relative;
                overflow: hidden;
            ">
                <div style="
                    position: absolute;
                    top: 0; left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(180deg, #8888ff, #5555cc);
                "></div>
                <div style="color:#8888ff; font-size: 0.8em; margin-bottom: 12px; letter-spacing: 2px; text-transform: uppercase;">
                    <span style="opacity: 0.7;">â–¸</span> ì‹ë¯¼ì§€ ì •ë³´
                </div>
                <div style="font-size: 0.9em; display: grid; gap: 6px;">
                    <div style="display:flex;justify-content:space-between;"><span style="color:#88a;">ìƒíƒœ</span> <span id="info-colony" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#88a;">ì¸êµ¬</span> <span id="info-population" style="color:#fff;"></span></div>
                    <div style="display:flex;justify-content:space-between;"><span style="color:#88a;">ì¸ê³µìœ„ì„±</span> <span><span id="info-satellites"></span><span style="color:#88a;font-size:0.8em;"> ê°œ</span></span></div>
                </div>
            </div>
        </div>
        
        <!-- í•˜ë‹¨ ë²„íŠ¼ -->
        <div style="padding: 15px 20px; border-top: 1px solid rgba(0,200,255,0.2); background: rgba(0,50,80,0.3);">
            <button id="body-info-goto" style="
                width: 100%;
                padding: 14px;
                background: linear-gradient(135deg, #0088ff, #0055cc);
                color: white;
                border: 1px solid rgba(0,150,255,0.5);
                border-radius: 10px;
                cursor: pointer;
                font-size: 0.95em;
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                letter-spacing: 1px;
                transition: all 0.3s;
                box-shadow: 0 0 20px rgba(0,100,255,0.3);
            " onmouseover="this.style.boxShadow='0 0 30px rgba(0,150,255,0.6)';this.style.transform='translateY(-2px)'" onmouseout="this.style.boxShadow='0 0 20px rgba(0,100,255,0.3)';this.style.transform='translateY(0)'">
                ğŸš€ ì„ ì²´ ë³´ê¸°
            </button>
        </div>
    </div>
    </div>

    <div id="msg-box" data-i18n="message">ë©”ì‹œì§€</div>
    <button id="reset-cam" data-i18n="viewAll">ğŸ”­ ì „ì²´ ë³´ê¸°</button>
    
    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div id="login-modal">
        <div id="login-content">
            <h2 id="login-title">ğŸ” <span data-i18n="login">Login</span></h2>
            <div class="login-tabs">
                <button class="login-tab active" id="tab-login" data-i18n="login">Login</button>
                <button class="login-tab" id="tab-register" data-i18n="register">Register</button>
            </div>
            
            <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… í¼ -->
            <div id="login-form">
                <input type="text" id="input-username" placeholder="ì‚¬ìš©ìëª…" data-placeholder-i18n="username">
                <input type="email" id="input-email" placeholder="ì´ë©”ì¼" style="display:none;" data-placeholder-i18n="email">
                <input type="password" id="input-password" placeholder="ë¹„ë°€ë²ˆí˜¸" data-placeholder-i18n="password">
                <input type="password" id="input-password-confirm" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" style="display:none;" data-placeholder-i18n="passwordConfirm">
                
                <!-- ì•½ê´€ ë™ì˜ (íšŒì›ê°€ì… ì‹œì—ë§Œ í‘œì‹œ) -->
                <div id="terms-agree-section" style="display:none; margin: 10px 0; font-size: 11px;">
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="agree-privacy" style="width: 16px; height: 16px;">
                            <span><a href="privacy.html" target="_blank" style="color: #0ff;" data-i18n="privacyPolicy">Privacy Policy</a> <span data-i18n="agreeToTerms">- I agree</span></span>
                        </label>
                    </div>
                    <div>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="agree-terms" style="width: 16px; height: 16px;">
                            <span><a href="terms.html" target="_blank" style="color: #0ff;" data-i18n="termsOfService">Terms of Service</a> <span data-i18n="agreeToTerms">- I agree</span></span>
                        </label>
                    </div>
                </div>
                
                <div id="login-error"></div>
                <div id="login-success"></div>
                <button id="btn-login-submit" class="login-submit" data-i18n="login">ë¡œê·¸ì¸</button>
                <div class="login-find-links" id="find-links">
                    <a id="link-find-id" data-i18n="findId">ì•„ì´ë”” ì°¾ê¸°</a>
                    <span style="color:#555;">|</span>
                    <a id="link-find-pw" data-i18n="findPassword">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
                </div>
            </div>
            
            <!-- ì•„ì´ë”” ì°¾ê¸° í¼ -->
            <div id="find-id-form" style="display:none;">
                <p style="color:#aaa; font-size:12px; margin-bottom:15px; text-align:center;" data-i18n="enterRegisteredEmail">ê°€ì…í•  ë•Œ ë“±ë¡í•œ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”</p>
                <input type="email" id="find-id-email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ" data-placeholder-i18n="emailAddress">
                <div id="find-id-error" style="color:#e74c3c; font-size:12px; min-height:18px; text-align:center;"></div>
                <div id="find-id-result" class="find-result" style="display:none;">
                    <div class="label" data-i18n="foundId">ì°¾ì€ ì•„ì´ë””</div>
                    <div class="value" id="found-username"></div>
                </div>
                <button id="btn-find-id" class="login-submit" data-i18n="findIdBtn">ì•„ì´ë”” ì°¾ê¸°</button>
                <button class="back-to-login" id="back-from-find-id" data-i18n="backToLoginBtn">â† ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
            
            <!-- ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° í¼ -->
            <div id="find-pw-form" style="display:none;">
                <p style="color:#aaa; font-size:12px; margin-bottom:15px; text-align:center;" data-i18n="enterIdAndEmailDesc">ì•„ì´ë””ì™€ ë“±ë¡ëœ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”</p>
                <input type="text" id="find-pw-username" placeholder="ì‚¬ìš©ìëª…" data-placeholder-i18n="username">
                <input type="email" id="find-pw-email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ" data-placeholder-i18n="emailAddress">
                <div id="find-pw-error" style="color:#e74c3c; font-size:12px; min-height:18px; text-align:center;"></div>
                <div id="find-pw-result" class="find-result" style="display:none;">
                    <div class="label" data-i18n="newPasswordSetMsg">ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤</div>
                    <div class="value" id="new-password"></div>
                    <p style="color:#888; font-size:10px; margin-top:8px;" data-i18n="changePasswordNote">ë¡œê·¸ì¸ í›„ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ì£¼ì„¸ìš”</p>
                </div>
                <button id="btn-find-pw" class="login-submit" data-i18n="resetPasswordBtn">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</button>
                <button class="back-to-login" id="back-from-find-pw" data-i18n="backToLoginBtn">â† ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
            
            <button id="login-close">âœ•</button>
        </div>
    </div>
    
    <!-- ì •ê±°ì¥ ì„ íƒ ëª¨ë‹¬ -->
    <div id="station-modal">
        <div id="station-modal-content">
            <button id="station-close">âœ•</button>
            <h2 data-i18n="selectStation">ğŸ›¸ ì •ê±°ì¥ ì„ íƒ</h2>
            <div class="station-category">
                <h3 data-i18n="orbitalStations">ğŸ“ ê¶¤ë„ ì •ê±°ì¥</h3>
                <div class="station-list" id="planet-stations"></div>
            </div>
            <div class="station-category">
                <h3 data-i18n="fuelDepots">â›½ ì—°ë£Œ ë³´ê¸‰ì†Œ</h3>
                <div class="station-list" id="fuel-stations"></div>
            </div>
        </div>
    </div>
    
    <!-- ì—°ë£Œ ì¶©ì „ íŒ¨ë„ -->
    <div id="refuel-panel">
        <h3 data-i18n="refueling">â›½ ì—°ë£Œ ì¶©ì „ ì¤‘...</h3>
        <div id="refuel-bar">
            <div id="refuel-progress"></div>
        </div>
        <div id="refuel-text">0/100</div>
    </div>
    
    <!-- í¬ì»¤ìŠ¤ ì²œì²´ ê±°ë¦¬ í‘œì‹œ -->
    <div id="focus-distance-panel">
        <div id="focus-target-name">---</div>
        <div id="focus-distance-value">--- km</div>
    </div>

    <div id="chat-toggle">ğŸ’¬</div>
    <div id="chat-panel">
        <div id="chat-header">
            <span data-i18n="spaceKnowledgeGuide">ğŸ›¸ ìš°ì£¼ ì§€ì‹ ê°€ì´ë“œ</span>
            <span id="chat-close">Ã—</span>
        </div>
        <div id="chat-messages">
            <div class="msg ai" data-i18n="aiWelcome">ì•ˆë…•í•˜ì„¸ìš”! ì²œì²´ë¼ë¦¬ ì¶©ëŒí•˜ë©´ í¡ìˆ˜ë˜ë©°, ì§ˆëŸ‰ì´ 100ì„ ë„˜ìœ¼ë©´ ë³„(í•­ì„±)ì´ ë©ë‹ˆë‹¤.</div>
        </div>
        <div id="chat-input-area">
            <input type="text" id="chat-input" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." data-placeholder-i18n="enterQuestion">
            <button id="chat-send">â¤</button>
        </div>
    </div>

    <div id="canvas-container"></div>

    <!-- ìš°ì£¼ì„  íƒ‘ìŠ¹ ë²„íŠ¼ -->
    <button id="board-ship-btn" data-i18n="boardShip">ğŸš€ ìš°ì£¼ì„  íƒ‘ìŠ¹</button>
    
    <!-- â˜…â˜…â˜… ìš´í•­ì¤‘ ìš°ì£¼ì„  íŒì—… â˜…â˜…â˜… -->
    <div id="active-ship-popup" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:10000; justify-content:center; align-items:center; overflow-y:auto; padding:20px 0;">
        <div style="background:linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border:2px solid #4fc3f7; border-radius:20px; padding:30px; max-width:400px; width:90%; max-height:85vh; overflow-y:auto; margin:auto; text-align:center; box-shadow:0 0 30px rgba(79,195,247,0.3); position:relative;">
            <div id="active-ship-icon" style="width:80px; height:80px; margin:0 auto 15px; border-radius:12px; background:#0a1628; border:2px solid #4fc3f7; display:flex; justify-content:center; align-items:center; overflow:hidden;">
                <span style="font-size:40px;">ğŸš€</span>
            </div>
            <h2 id="active-ship-title" style="color:#4fc3f7; margin:0 0 20px 0; font-size:20px;">Active Ship Found!</h2>
            <div id="active-ship-info" style="background:rgba(0,0,0,0.3); border-radius:10px; padding:15px; margin-bottom:20px; text-align:left;">
                <div style="color:#fff; font-size:18px; margin-bottom:10px;" id="active-ship-name">Interceptor</div>
                <div style="color:#aaa; font-size:14px;">
                    <div style="margin-bottom:5px;"><span id="active-ship-fuel-label">â›½ Fuel:</span> <span id="active-ship-fuel" style="color:#4fc3f7;">20%</span></div>
                    <div><span id="active-ship-dist-label">ğŸ“ From ISS:</span> <span id="active-ship-dist" style="color:#4fc3f7;">11,176km</span></div>
                </div>
            </div>
            <div style="display:flex; gap:15px; justify-content:center;">
                <button id="active-ship-go-btn" style="flex:1; padding:15px 20px; background:linear-gradient(135deg,#4fc3f7,#2196f3); border:none; border-radius:10px; color:#fff; font-size:16px; font-weight:bold; cursor:pointer;">
                    ğŸ“ Go to Ship
                </button>
                <button id="active-ship-new-btn" style="flex:1; padding:15px 20px; background:linear-gradient(135deg,#e74c3c,#c0392b); border:none; border-radius:10px; color:#fff; font-size:16px; font-weight:bold; cursor:pointer;">
                    ğŸ—‘ï¸ New Ship
                </button>
            </div>
            <button id="active-ship-close-btn" style="position:absolute; top:15px; right:15px; background:none; border:none; color:#888; font-size:24px; cursor:pointer;">âœ•</button>
        </div>
    </div>
    
    <!-- ìš°ì£¼ì„  ìœ„ì¹˜ ë§ˆì»¤ (ë§µì— í‘œì‹œ) -->
    <div id="ship-location-marker" style="display:none; position:fixed; z-index:1000; cursor:pointer;" onclick="focusOnParkedShip()">
        <div style="display:flex; flex-direction:column; align-items:center;">
            <div id="ship-marker-box" style="width:60px; height:60px; border-radius:10px; background:#0a1628; border:2px solid #00ff00; box-shadow:0 0 15px rgba(0,255,0,0.5); display:flex; justify-content:center; align-items:center; overflow:hidden;">
                <span style="font-size:30px;">ğŸš€</span>
            </div>
            <div style="width:0; height:0; border-left:10px solid transparent; border-right:10px solid transparent; border-top:15px solid #00ff00; margin-top:-2px;"></div>
            <div id="ship-marker-name" style="color:#00ff00; font-size:12px; font-weight:bold; text-shadow:0 0 5px #000; margin-top:5px; white-space:nowrap;"></div>
        </div>
    </div>
    
    <!-- ìš°ì£¼ì„  ì„ íƒ ëª¨ë‹¬ -->
    <div id="ship-select-modal">
        <div id="ship-select-content">
            <h2 data-i18n="selectShip">ğŸš€ ìš°ì£¼ì„  ì„ íƒ</h2>
            <div id="ship-list"></div>
            <div id="ship-detail">
                <div id="ship-preview"></div>
                <div id="ship-info">
                    <h3 id="ship-detail-name" data-i18n="shuttle">ì…”í‹€</h3>
                    <p id="ship-detail-desc" data-i18n="shuttleDesc">ê¸°ë³¸í˜• ì™•ë³µì„ </p>
                    <div id="ship-price-display">
                        <span class="price-label">ğŸª™</span>
                        <span id="ship-price-value">500</span>
                        <span id="ship-owned-badge" style="display:none;" data-i18n="owned">ë³´ìœ ì¤‘</span>
                    </div>
                    <div id="ship-stats">
                        <div class="stat-row"><span data-i18n="maxSpeed">ìµœëŒ€ ì†ë„</span><div class="stat-bar"><div class="stat-fill speed"></div></div><span class="stat-val" id="stat-speed">75 km/s</span></div>
                        <div class="stat-row"><span data-i18n="accelStat">ê°€ì†ë ¥</span><div class="stat-bar"><div class="stat-fill accel"></div></div><span class="stat-val" id="stat-accel">1.0</span></div>
                        <div class="stat-row"><span data-i18n="turnRate">ì„ íšŒë ¥</span><div class="stat-bar"><div class="stat-fill turn"></div></div><span class="stat-val" id="stat-turn">0.125</span></div>
                        <div class="stat-row"><span data-i18n="fuel">ì—°ë£Œ</span><div class="stat-bar"><div class="stat-fill fuel"></div></div><span class="stat-val" id="stat-fuel">250</span></div>
                    </div>
                    <div id="ship-special"></div>
                </div>
            </div>
            <div id="ship-select-buttons">
                <button id="btn-armory" class="ship-modal-btn armory" data-i18n="armory">âš”ï¸ ë¬´ì¥</button>
                <button id="btn-buy-ship" class="ship-modal-btn buy" style="display:none;" data-i18n="buy">ğŸª™ êµ¬ë§¤</button>
                <button id="btn-select-ship" class="ship-modal-btn confirm" data-i18n="launch">ì¶œê²©</button>
                <button id="btn-cancel-ship" class="ship-modal-btn cancel" data-i18n="cancel">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>
    
    <!-- í•¨ì„  ì²˜ë¶„ í™•ì¸ ëª¨ë‹¬ -->
    <div id="sell-ship-modal">
        <div id="sell-ship-content">
            <h2>âš ï¸ <span data-i18n="sellShipTitle">í•¨ì„  ì²˜ë¶„</span></h2>
            <p id="sell-ship-message"></p>
            <div id="sell-ship-info">
                <div class="sell-info-row">
                    <span data-i18n="currentShip">í˜„ì¬ í•¨ì„ :</span>
                    <span id="sell-current-ship" data-i18n="shuttle">ì…”í‹€</span>
                </div>
                <div class="sell-info-row">
                    <span data-i18n="sellPrice">ì²˜ë¶„ ê°€ê²© (50%):</span>
                    <span id="sell-price-value">ğŸª™ 250</span>
                </div>
            </div>
            <div id="sell-ship-buttons">
                <button id="btn-sell-confirm" class="ship-modal-btn sell">ğŸ’° <span data-i18n="sellAndBoard">ì²˜ë¶„ í›„ íƒ‘ìŠ¹</span></button>
                <button id="btn-sell-cancel" class="ship-modal-btn cancel" data-i18n="cancel">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- ë¬´ì¥ ëª¨ë‹¬ -->
    <div id="armory-modal">
        <div id="armory-content">
            <h2 data-i18n="armorySystem">âš”ï¸ ë¬´ì¥ ì‹œìŠ¤í…œ</h2>
            <div class="armory-tabs">
                <button class="armory-tab active" data-tab="weapons">ğŸ”« ë¬´ê¸°</button>
                <button class="armory-tab" data-tab="armors">ğŸ›¡ï¸ ì¥ê°‘</button>
            </div>
            <!-- â˜… ì ì¬ëŸ‰ ë°” -->
            <div id="armory-capacity-bar" style="margin: 10px 0; padding: 8px; background: rgba(0,0,0,0.3); border-radius: 5px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px;">
                    <span>ğŸ“¦ ì ì¬ëŸ‰</span>
                    <span id="armory-capacity-text">0 / 100</span>
                </div>
                <div style="background: #333; border-radius: 3px; height: 8px; overflow: hidden;">
                    <div id="armory-capacity-fill" style="background: linear-gradient(90deg, #27ae60, #2ecc71); height: 100%; width: 0%; transition: width 0.3s;"></div>
                </div>
            </div>
            <div class="armory-main">
                <div class="armory-list-container">
                    <div id="armory-list" class="armory-list"></div>
                </div>
                <div class="armory-detail">
                    <div class="armory-equipped-section">
                        <div class="armory-equipped-title">ğŸ“¦ Equipped</div>
                        <div id="armory-equipped-slots"></div>
                    </div>
                    <div class="armory-detail-icon" id="armory-detail-icon">ğŸ”«</div>
                    <h3 id="armory-detail-name" data-i18n="selectWeapon">Select Weapon</h3>
                    <div class="armory-detail-desc" id="armory-detail-desc" data-i18n="selectWeaponDesc">Select a weapon</div>
                    <div class="armory-detail-stats" id="armory-detail-stats"></div>
                    <div class="armory-detail-effect" id="armory-detail-effect" style="display:none;"></div>
                    <div id="armory-detail-price" style="text-align:center; margin-bottom: 10px;"></div>
                    <div class="armory-buttons">
                        <button id="btn-armory-buy" class="ship-modal-btn buy" style="display:none;" data-i18n="buy">ğŸª™ Buy</button>
                        <button id="btn-armory-equip" class="ship-modal-btn confirm" style="display:none;">Equip</button>
                        <button id="btn-armory-unequip" class="ship-modal-btn cancel" style="display:none;">Unequip</button>
                    </div>
                </div>
            </div>
            <div class="armory-buttons" style="margin-top: 15px;">
                <button id="btn-armory-close" class="ship-modal-btn cancel" data-i18n="close">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- â˜…â˜…â˜… ì¡°ì¢…ì„ ëª¨ë“œ ì¢Œì¸¡ í”„ë¡œí•„ â˜…â˜…â˜… -->
    <div id="pilot-profile">
        <div class="pilot-profile-avatar" id="pilot-profile-avatar">ğŸ‘¤</div>
        <div class="pilot-profile-info">
            <div class="pilot-profile-name" id="pilot-profile-name">Pilot</div>
            <div class="pilot-profile-stats">
                <span>ğŸª™ <span id="pilot-profile-coins">0</span></span>
                <span>â­ Lv.<span id="pilot-profile-level">1</span></span>
            </div>
        </div>
    </div>

    <!-- â˜…â˜…â˜… ì¡°ì¢…ì„ ëª¨ë“œ ìš°ì¸¡ í†µì¼ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ â˜…â˜…â˜… -->
    <div id="pilot-right-btns">
        <button id="pilot-home-btn" class="pilot-unified-btn" title="Home" onclick="goToMainMenu();">ğŸ </button>
        <button id="ui-settings-btn" class="pilot-unified-btn" title="UI Settings">âš™ï¸</button>
        <button id="radio-btn-unified" class="pilot-unified-btn" title="Radio">ğŸ“»</button>
        <button id="ad-btn-unified" class="pilot-unified-btn" title="Ad Rewards">ğŸ“‹</button>
        <button id="ssil-btn-unified" class="pilot-unified-btn" title="SSIL Mission">ğŸš€</button>
    </div>

    <!-- â˜…â˜…â˜… ëª¨ë°”ì¼ ë°œì‚¬/ì—­ì¶”ì§„ ë²„íŠ¼ (í•­ìƒ í‘œì‹œ) â˜…â˜…â˜… -->
    <div id="mobile-combat-btns">
        <button id="mobile-fire-btn-new" class="mobile-combat-btn fire" title="Fire">ğŸ”¥</button>
        <button id="mobile-brake-btn-new" class="mobile-combat-btn brake" title="Emergency Brake">â¹ï¸</button>
    </div>

    <script src="js/cockpit-buttons.js"></script>

    <!-- UI ì„¤ì • íŒ¨ë„ -->
    <div id="ui-settings-panel">
        <button id="ui-settings-close" onclick="this.parentElement.classList.remove('open');">âœ•</button>
        <h3 data-i18n="uiSettings">ğŸ›ï¸ ê²Œì„ ì„¤ì •</h3>

        <!-- â˜…â˜…â˜… ê·¸ë˜í”½ ì„¤ì • ì„¹ì…˜ â˜…â˜…â˜… -->
        <div class="settings-section">
            <div class="settings-section-title">ğŸ¨ ê·¸ë˜í”½</div>

            <div class="setting-item">
                <label>í•´ìƒë„ ë°°ìœ¨</label>
                <input type="range" id="setting-pixel-ratio" min="0.25" max="2" step="0.25" value="1">
                <span id="setting-pixel-ratio-value">1x</span>
                <button class="setting-help-btn" data-help="pixel-ratio">?</button>
            </div>

            <div class="setting-item">
                <label>ê·¸ë¦¼ì</label>
                <select id="setting-shadows">
                    <option value="off">ë”</option>
                    <option value="low">ë‚®ìŒ</option>
                    <option value="medium" selected>ì¤‘ê°„</option>
                    <option value="high">ë†’ìŒ</option>
                </select>
                <button class="setting-help-btn" data-help="shadows">?</button>
            </div>

            <div class="setting-item">
                <label>ì•ˆí‹°ì•¨ë¦¬ì–´ì‹±</label>
                <select id="setting-antialias">
                    <option value="off">ë”</option>
                    <option value="on" selected>ì¼¬</option>
                </select>
                <button class="setting-help-btn" data-help="antialias">?</button>
            </div>

            <div class="setting-item">
                <label>ê¶¤ë„ì„  í‘œì‹œ</label>
                <select id="setting-orbits">
                    <option value="off">ë”</option>
                    <option value="on" selected>ì¼¬</option>
                </select>
                <button class="setting-help-btn" data-help="orbits">?</button>
            </div>

            <div class="setting-item">
                <label>ë³„ ë°°ê²½</label>
                <select id="setting-stars">
                    <option value="low">ì ìŒ (1000)</option>
                    <option value="medium" selected>ë³´í†µ (5000)</option>
                    <option value="high">ë§ìŒ (10000)</option>
                </select>
                <button class="setting-help-btn" data-help="stars">?</button>
            </div>

            <div class="setting-item">
                <label>ìµœëŒ€ ì¤Œ ê±°ë¦¬</label>
                <input type="range" id="setting-render-distance" min="1000" max="50000" step="1000" value="10000">
                <span id="setting-render-distance-value">10000</span>
                <button class="setting-help-btn" data-help="render-distance">?</button>
            </div>
        </div>

        <!-- â˜…â˜…â˜… ë©€í‹°í”Œë ˆì´ì–´ ì„¤ì • â˜…â˜…â˜… -->
        <div class="settings-section">
            <div class="settings-section-title">ğŸŒ ë©€í‹°í”Œë ˆì´ì–´</div>

            <div class="setting-item">
                <label>ìœ„ì¹˜ ë™ê¸°í™”</label>
                <select id="setting-mp-sync">
                    <option value="fast">ë¹ ë¦„ (50ms)</option>
                    <option value="normal" selected>ë³´í†µ (100ms)</option>
                    <option value="slow">ëŠë¦¼ (200ms)</option>
                </select>
                <button class="setting-help-btn" data-help="mp-sync">?</button>
            </div>

            <div class="setting-item">
                <label>ë³´ê°„ ì†ë„</label>
                <input type="range" id="setting-mp-interpolation" min="2" max="15" step="1" value="8">
                <span id="setting-mp-interpolation-value">8</span>
                <button class="setting-help-btn" data-help="mp-interpolation">?</button>
            </div>
        </div>

        <!-- â˜…â˜…â˜… UI ì„¤ì • ì„¹ì…˜ â˜…â˜…â˜… -->
        <div class="settings-section">
            <div class="settings-section-title">ğŸ“ UI ë°°ì¹˜</div>

            <div style="display:flex;flex-direction:column;gap:10px;">
                <button class="ui-preset-btn" id="ui-rearrange-mode" style="background:linear-gradient(135deg,#9b59b6,#8e44ad);" data-i18n="uiReposition" onclick="document.getElementById('ui-settings-panel').classList.remove('open'); if(window.uiRearrangeSystem) uiRearrangeSystem.start();">
                    ğŸ”§ UI ì¬ë°°ì¹˜ ëª¨ë“œ
                </button>
                <p style="font-size:10px;color:#888;text-align:center;margin:0;" data-i18n="uiDragToMove">
                    ì¬ë°°ì¹˜ ëª¨ë“œì—ì„œ UIë¥¼ ë“œë˜ê·¸í•˜ì—¬ ì´ë™
                </p>
            </div>

            <div class="ui-slots-container" style="margin-top:10px;">
                <div class="ui-slots-title" data-i18n="saveSlots">ğŸ’¾ ì €ì¥ ìŠ¬ë¡¯</div>
                <div id="ui-slots-list">
                    <!-- ìŠ¬ë¡¯ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <button class="ui-preset-btn" id="settings-apply" style="background:linear-gradient(135deg,#27ae60,#2ecc71);margin-top:10px;" onclick="applyGameSettings();">âœ“ ì„¤ì • ì ìš©</button>
        <button class="ui-preset-btn danger" id="ui-reset-default" data-i18n="resetDefault" onclick="resetAllSettings();">ğŸ”„ ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹</button>
    </div>

    <!-- â˜…â˜…â˜… ê²Œì„ ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ â˜…â˜…â˜… -->
    <script>
    (function() {
        // ê¸°ë³¸ ì„¤ì •ê°’
        const DEFAULT_SETTINGS = {
            pixelRatio: 1,
            shadows: 'medium',
            antialias: 'on',
            orbits: 'on',
            stars: 'medium',
            renderDistance: 10000,
            mpSync: 'normal',
            mpInterpolation: 8
        };

        // ì„¤ì • ë¡œë“œ
        function loadSettings() {
            const saved = localStorage.getItem('game-settings');
            return saved ? JSON.parse(saved) : { ...DEFAULT_SETTINGS };
        }

        // ì„¤ì • ì €ì¥
        function saveSettings(settings) {
            localStorage.setItem('game-settings', JSON.stringify(settings));
        }

        // ìŠ¬ë¼ì´ë” ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
        function initSettingsUI() {
            const settings = loadSettings();

            // í•´ìƒë„ ë°°ìœ¨
            const prSlider = document.getElementById('setting-pixel-ratio');
            const prValue = document.getElementById('setting-pixel-ratio-value');
            if (prSlider && prValue) {
                prSlider.value = settings.pixelRatio;
                prValue.textContent = settings.pixelRatio + 'x';
                prSlider.oninput = () => { prValue.textContent = prSlider.value + 'x'; };
            }

            // ë Œë”ë§ ê±°ë¦¬
            const rdSlider = document.getElementById('setting-render-distance');
            const rdValue = document.getElementById('setting-render-distance-value');
            if (rdSlider && rdValue) {
                rdSlider.value = settings.renderDistance;
                rdValue.textContent = settings.renderDistance;
                rdSlider.oninput = () => { rdValue.textContent = rdSlider.value; };
            }

            // ë³´ê°„ ì†ë„
            const ipSlider = document.getElementById('setting-mp-interpolation');
            const ipValue = document.getElementById('setting-mp-interpolation-value');
            if (ipSlider && ipValue) {
                ipSlider.value = settings.mpInterpolation;
                ipValue.textContent = settings.mpInterpolation;
                ipSlider.oninput = () => { ipValue.textContent = ipSlider.value; };
            }

            // Select ìš”ì†Œë“¤
            const selects = ['shadows', 'antialias', 'orbits', 'stars', 'mpSync'];
            selects.forEach(key => {
                const el = document.getElementById('setting-' + key.replace(/([A-Z])/g, '-$1').toLowerCase());
                if (el && settings[key]) el.value = settings[key];
            });

            // mp-sync íŠ¹ë³„ ì²˜ë¦¬
            const mpSyncEl = document.getElementById('setting-mp-sync');
            if (mpSyncEl && settings.mpSync) mpSyncEl.value = settings.mpSync;
        }

        // ì„¤ì • ì ìš©
        window.applyGameSettings = function() {
            const settings = {
                pixelRatio: parseFloat(document.getElementById('setting-pixel-ratio')?.value || 1),
                shadows: document.getElementById('setting-shadows')?.value || 'medium',
                antialias: document.getElementById('setting-antialias')?.value || 'on',
                orbits: document.getElementById('setting-orbits')?.value || 'on',
                stars: document.getElementById('setting-stars')?.value || 'medium',
                renderDistance: parseInt(document.getElementById('setting-render-distance')?.value || 5000),
                mpSync: document.getElementById('setting-mp-sync')?.value || 'normal',
                mpInterpolation: parseInt(document.getElementById('setting-mp-interpolation')?.value || 8)
            };

            saveSettings(settings);
            applySettingsToGame(settings);

            // íŒ¨ë„ ë‹«ê¸°
            document.getElementById('ui-settings-panel').classList.remove('open');
            if (typeof showMsg === 'function') showMsg('ì„¤ì •ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤');
        };

        // ì„¤ì • ë¦¬ì…‹
        window.resetAllSettings = function() {
            saveSettings(DEFAULT_SETTINGS);
            initSettingsUI();
            applySettingsToGame(DEFAULT_SETTINGS);

            // UI ë°°ì¹˜ë„ ë¦¬ì…‹
            if (window.draggableUISystem) draggableUISystem.resetToDefault();

            document.getElementById('ui-settings-panel').classList.remove('open');
            if (typeof showMsg === 'function') showMsg('ì„¤ì •ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
        };

        // ì‹¤ì œ ê²Œì„ì— ì„¤ì • ì ìš©
        function applySettingsToGame(settings) {
            // 1. í•´ìƒë„ ë°°ìœ¨
            if (window.renderer) {
                window.renderer.setPixelRatio(settings.pixelRatio * window.devicePixelRatio);
            }

            // 2. ê·¸ë¦¼ì
            if (window.renderer) {
                window.renderer.shadowMap.enabled = settings.shadows !== 'off';
                if (settings.shadows === 'low') {
                    window.renderer.shadowMap.type = THREE.BasicShadowMap;
                } else if (settings.shadows === 'medium') {
                    window.renderer.shadowMap.type = THREE.PCFShadowMap;
                } else if (settings.shadows === 'high') {
                    window.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                }
            }

            // 3. ê¶¤ë„ì„  í‘œì‹œ
            if (typeof window.orbitLines !== 'undefined') {
                const showOrbits = settings.orbits === 'on';
                Object.values(window.orbitLines || {}).forEach(line => {
                    if (line) line.visible = showOrbits;
                });
            }

            // 4. ìµœëŒ€ ì¤Œ ê±°ë¦¬ (camera.farëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ - ë°°ê²½ ë³„ ë Œë”ë§ ìœ ì§€)
            if (window.controls) {
                window.controls.maxDistance = settings.renderDistance;
            }

            // 5. ë©€í‹°í”Œë ˆì´ì–´ ë™ê¸°í™” ì†ë„
            if (typeof window.MP_UPDATE_INTERVAL !== 'undefined') {
                const syncValues = { fast: 50, normal: 100, slow: 200 };
                window.MP_UPDATE_INTERVAL_OVERRIDE = syncValues[settings.mpSync] || 100;
            }

            // 6. ë©€í‹°í”Œë ˆì´ì–´ ë³´ê°„ ì†ë„
            if (typeof window.MP_INTERPOLATION_SPEED !== 'undefined') {
                window.MP_INTERPOLATION_SPEED = settings.mpInterpolation;
            }
            // ì§ì ‘ multiplayer.js ë³€ìˆ˜ ì„¤ì •
            window.mpInterpolationSpeed = settings.mpInterpolation;

            console.log('ê²Œì„ ì„¤ì • ì ìš©ë¨:', settings);
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            initSettingsUI();
            // ì €ì¥ëœ ì„¤ì • ì ìš©
            const settings = loadSettings();
            setTimeout(() => applySettingsToGame(settings), 1000);
        });
    })();
    </script>

    <!-- â˜…â˜…â˜… ì„¤ì • ë„ì›€ë§ íˆ´íŒ ì‹œìŠ¤í…œ â˜…â˜…â˜… -->
    <div class="setting-tooltip-overlay" id="setting-tooltip-overlay"></div>
    <script>
    (function() {
        // ë„ì›€ë§ ë°ì´í„°
        const HELP_DATA = {
            'pixel-ratio': {
                title: 'í•´ìƒë„ ë°°ìœ¨',
                content: 'ë Œë”ë§ í•´ìƒë„ë¥¼ ì¡°ì ˆí•©ë‹ˆë‹¤.\n\nâ€¢ ë‚®ìŒ (0.5x): ì„±ëŠ¥ â†‘, í™”ì§ˆ â†“\nâ€¢ ë³´í†µ (1x): ê· í˜• ì¡íŒ ì„¤ì •\nâ€¢ ë†’ìŒ (2x): í™”ì§ˆ â†‘, ì„±ëŠ¥ â†“\n\nì €ì‚¬ì–‘ ê¸°ê¸°ì—ì„œëŠ” ë‚®ì€ ê°’ì„ ì¶”ì²œí•©ë‹ˆë‹¤.'
            },
            'shadows': {
                title: 'ê·¸ë¦¼ì',
                content: 'í–‰ì„±ê³¼ ìš°ì£¼ì„ ì˜ ê·¸ë¦¼ì í’ˆì§ˆì…ë‹ˆë‹¤.\n\nâ€¢ ë”: ê·¸ë¦¼ì ì—†ìŒ (ì„±ëŠ¥ ìµœì )\nâ€¢ ë‚®ìŒ: ê¸°ë³¸ ê·¸ë¦¼ì\nâ€¢ ì¤‘ê°„: ë¶€ë“œëŸ¬ìš´ ê·¸ë¦¼ì\nâ€¢ ë†’ìŒ: ê³ í’ˆì§ˆ ê·¸ë¦¼ì (ì„±ëŠ¥ â†“)\n\nëª¨ë°”ì¼ì—ì„œëŠ” "ë‚®ìŒ" ì¶”ì²œ.'
            },
            'antialias': {
                title: 'ì•ˆí‹°ì•¨ë¦¬ì–´ì‹±',
                content: '3D ê°ì²´ì˜ ê°€ì¥ìë¦¬ë¥¼ ë¶€ë“œëŸ½ê²Œ í•©ë‹ˆë‹¤.\n\nâ€¢ ì¼¬: ê³„ë‹¨ í˜„ìƒ ê°ì†Œ, ë¶€ë“œëŸ¬ìš´ í™”ë©´\nâ€¢ ë”: ì•½ê°„ì˜ ì„±ëŠ¥ í–¥ìƒ\n\nëŒ€ë¶€ë¶„ì˜ ê²½ìš° "ì¼¬" ì¶”ì²œ.'
            },
            'orbits': {
                title: 'ê¶¤ë„ì„  í‘œì‹œ',
                content: 'í–‰ì„±ì˜ ê³µì „ ê¶¤ë„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\nâ€¢ ì¼¬: ê¶¤ë„ ì› í‘œì‹œ\nâ€¢ ë”: ê¶¤ë„ ìˆ¨ê¹€\n\níƒìƒ‰ ì‹œì—ëŠ” ì¼œë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.'
            },
            'stars': {
                title: 'ë³„ ë°°ê²½',
                content: 'ë°°ê²½ì— í‘œì‹œë˜ëŠ” ë³„ì˜ ê°œìˆ˜ì…ë‹ˆë‹¤.\n\nâ€¢ ì ìŒ (1000): ì„±ëŠ¥ ìµœì í™”\nâ€¢ ë³´í†µ (5000): ì ë‹¹í•œ ë°€ë„\nâ€¢ ë§ìŒ (10000): í’ë¶€í•œ ìš°ì£¼ ë°°ê²½\n\nì €ì‚¬ì–‘ ê¸°ê¸°ì—ì„œëŠ” "ì ìŒ" ì¶”ì²œ.'
            },
            'render-distance': {
                title: 'ìµœëŒ€ ì¤Œ ê±°ë¦¬',
                content: 'ì¹´ë©”ë¼ê°€ ì–¼ë§ˆë‚˜ ë©€ë¦¬ ì¤Œì•„ì›ƒí•  ìˆ˜ ìˆëŠ”ì§€ ì„¤ì •í•©ë‹ˆë‹¤.\n\nâ€¢ ë‚®ìŒ: ê°€ê¹Œìš´ ë²”ìœ„ë§Œ ë³¼ ìˆ˜ ìˆìŒ\nâ€¢ ë†’ìŒ: íƒœì–‘ê³„ ì „ì²´ë¥¼ ë³¼ ìˆ˜ ìˆìŒ\n\nì„±ëŠ¥ì—ëŠ” í° ì˜í–¥ì´ ì—†ìŠµë‹ˆë‹¤.'
            },
            'mp-sync': {
                title: 'ìœ„ì¹˜ ë™ê¸°í™”',
                content: 'ë‹¤ë¥¸ í”Œë ˆì´ì–´ ìœ„ì¹˜ë¥¼ ì–¼ë§ˆë‚˜ ìì£¼ ë°›ì„ì§€ ì„¤ì •í•©ë‹ˆë‹¤.\n\nâ€¢ ë¹ ë¦„ (50ms): ë¶€ë“œëŸ½ì§€ë§Œ ë°ì´í„° ì‚¬ìš© â†‘\nâ€¢ ë³´í†µ (100ms): ê· í˜• ì¡íŒ ì„¤ì •\nâ€¢ ëŠë¦¼ (200ms): ë°ì´í„° ì ˆì•½\n\nì™€ì´íŒŒì´ í™˜ê²½ì—ì„œëŠ” "ë¹ ë¦„" ì¶”ì²œ.'
            },
            'mp-interpolation': {
                title: 'ë³´ê°„ ì†ë„',
                content: 'ë‹¤ë¥¸ í”Œë ˆì´ì–´ì˜ ì›€ì§ì„ì„ ì–¼ë§ˆë‚˜ ë¶€ë“œëŸ½ê²Œ ë³´ê°„í• ì§€ ì„¤ì •í•©ë‹ˆë‹¤.\n\nâ€¢ ë‚®ìŒ (2-5): ì •í™•í•˜ì§€ë§Œ ëŠê¹€\nâ€¢ ë³´í†µ (6-10): ê· í˜• ì¡íŒ ì„¤ì •\nâ€¢ ë†’ìŒ (11-15): ë§¤ìš° ë¶€ë“œëŸ½ì§€ë§Œ ì§€ì—°\n\n"8" ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤.'
            }
        };

        let currentTooltip = null;
        const overlay = document.getElementById('setting-tooltip-overlay');

        // íˆ´íŒ ìˆ¨ê¸°ê¸°
        function hideTooltip() {
            if (currentTooltip) {
                currentTooltip.remove();
                currentTooltip = null;
            }
            overlay.classList.remove('active');
        }

        // íˆ´íŒ í‘œì‹œ
        function showTooltip(helpKey, btnRect) {
            hideTooltip();

            const data = HELP_DATA[helpKey];
            if (!data) return;

            overlay.classList.add('active');

            // íˆ´íŒ ìƒì„±
            const tooltip = document.createElement('div');
            tooltip.className = 'setting-tooltip';
            tooltip.innerHTML = `
                <div class="setting-tooltip-title">${data.title}</div>
                <div class="setting-tooltip-content">${data.content.replace(/\n/g, '<br>')}</div>
                <div class="setting-tooltip-arrow left"></div>
            `;
            document.body.appendChild(tooltip);
            currentTooltip = tooltip;

            // ìœ„ì¹˜ ê³„ì‚°
            const tooltipRect = tooltip.getBoundingClientRect();
            let left = btnRect.left - tooltipRect.width - 15;
            let top = btnRect.top + btnRect.height / 2 - tooltipRect.height / 2;

            // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ì¡°ì •
            if (left < 10) {
                left = btnRect.right + 15;
                tooltip.querySelector('.setting-tooltip-arrow').className = 'setting-tooltip-arrow';
                tooltip.querySelector('.setting-tooltip-arrow').style.cssText =
                    'left: -8px; top: 50%; transform: translateY(-50%); border-width: 8px 8px 8px 0; border-color: transparent #0ff transparent transparent;';
            }
            if (top < 10) top = 10;
            if (top + tooltipRect.height > window.innerHeight - 10) {
                top = window.innerHeight - tooltipRect.height - 10;
            }

            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
        }

        // ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ë‹«ê¸°
        overlay.addEventListener('click', hideTooltip);
        overlay.addEventListener('touchstart', hideTooltip);

        // ë„ì›€ë§ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ìœ„ì„)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('setting-help-btn')) {
                e.preventDefault();
                e.stopPropagation();
                const helpKey = e.target.dataset.help;
                const rect = e.target.getBoundingClientRect();
                showTooltip(helpKey, rect);
            }
        });

        // ì „ì—­ í•¨ìˆ˜ë¡œ ë‚´ë³´ë‚´ê¸° (ë‹¤ë¥¸ ì„¤ì • íŒ¨ë„ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥)
        window.showSettingHelp = showTooltip;
        window.hideSettingHelp = hideTooltip;
    })();
    </script>

    <!-- UI ì¬ë°°ì¹˜ ëª¨ë“œ ì˜¤ë²„ë ˆì´ -->
    <div id="ui-rearrange-overlay">
        <div class="rearrange-header">
            <span data-i18n="uiReposition">ğŸ”§ UI ì¬ë°°ì¹˜ ëª¨ë“œ</span>
            <span style="font-size:12px;color:#aaa;" data-i18n="uiDragToMove">UIë¥¼ ë“œë˜ê·¸í•˜ì—¬ ì´ë™í•˜ì„¸ìš”</span>
        </div>
        <button id="ui-rearrange-done" data-i18n="done" onclick="if(window.uiRearrangeSystem) uiRearrangeSystem.stop();">âœ“ ì™„ë£Œ</button>
    </div>

    <!-- ì¡°ì¢…ì„ HUD -->
    <!-- ì¡°ì¢…ì‹¤ ë¼ë””ì˜¤ íŒ¨ë„ -->
    <div id="cockpit-radio" class="collapsed draggable-ui">
        <button class="radio-toggle" id="radio-toggle-btn">ğŸ“»</button>
        <div class="radio-content">
            <div class="radio-header">
                <div class="radio-title" data-i18n="spaceRadio">ğŸ›¸ ìš°ì£¼ ë¼ë””ì˜¤</div>
                <button id="radio-close-btn" class="radio-close-btn">âœ•</button>
            </div>
            <div class="radio-station" data-url="https://ice.somafm.com/spacestation" data-name="Space Station Soma">
                <div class="radio-station-name" data-i18n="spaceStation">ğŸš€ ìš°ì£¼ ì •ê±°ì¥</div>
                <div class="radio-station-desc">Spaced-out ambient electronica</div>
            </div>
            <div class="radio-station" data-url="https://ice.somafm.com/deepspaceone" data-name="Deep Space One">
                <div class="radio-station-name">ğŸŒŒ Deep Space One</div>
                <div class="radio-station-desc">Deep ambient space music</div>
            </div>
            <div class="radio-station" data-url="https://ice.somafm.com/dronezone" data-name="Drone Zone">
                <div class="radio-station-name">ğŸ§ Drone Zone</div>
                <div class="radio-station-desc">Atmospheric textures</div>
            </div>
            <div class="radio-station" data-url="https://ice.somafm.com/groovesalad" data-name="Groove Salad">
                <div class="radio-station-name">ğŸ¥— Groove Salad</div>
                <div class="radio-station-desc">Ambient downtempo beats</div>
            </div>
            <div class="radio-station" data-url="https://ice.somafm.com/defcon" data-name="DEF CON Radio">
                <div class="radio-station-name">ğŸ’» DEF CON</div>
                <div class="radio-station-desc">Music for Hacking</div>
            </div>
            <div class="radio-volume">
                <span>ğŸ”Š</span>
                <input type="range" id="radio-volume" min="0" max="100" value="30">
                <span id="radio-vol-val">30%</span>
            </div>
            <div class="radio-now-playing" id="radio-now-playing" data-i18n="selectChannel">ğŸ“¡ Select a channel</div>
        </div>
    </div>

    <div id="cockpit-hud">
        <!-- ì½•í• í”„ë ˆì„ (1ì¸ì¹­ ë·°) -->
        <div id="cockpit-frame">
            <div class="cockpit-strut left"></div>
            <div class="cockpit-strut right"></div>
            <div class="cockpit-strut top"></div>
            <div class="cockpit-side-panel left"></div>
            <div class="cockpit-side-panel right"></div>
            <div id="cockpit-dashboard"></div>
            <div class="cockpit-indicator left"></div>
            <div class="cockpit-indicator right"></div>
        </div>
        <div id="pilot-top-bar">
            <div class="pilot-info-panel" id="status-panel" style="border-color:#0f0;display:none;"><div class="pilot-info-label" style="color:#0f0;" data-i18n="status">ìƒíƒœ</div><div class="pilot-info-value" id="info-status" style="color:#0f0;">ì •ìƒ</div></div>
            <button class="pilot-info-panel ability-btn" id="btn-ability" style="display:none;"><span id="ability-icon">âš¡</span><span id="ability-name">íŠ¹ìˆ˜ëŠ¥ë ¥</span><span id="ability-cooldown"></span></button>
        </div>
        
        <!-- â˜… í™”ë©´ ì¤‘ì•™ ë„í‚¹ ë²„íŠ¼ -->
        <button id="docking-center-btn" data-i18n="docking">ğŸ”— ë„í‚¹</button>
        
        <!-- â˜… ë„í‚¹ ì™„ë£Œ í›„ ë©”ë‰´ -->
        <div id="docking-menu">
            <button class="docking-menu-btn" id="btn-refuel-menu" data-i18n="refuelMenu">â›½ ì—°ë£Œ ë³´ì¶©</button>
            <button class="docking-menu-btn repair" id="btn-repair-menu">ğŸ”§ ì„ ì²´ ìˆ˜ë¦¬</button>
            <button class="docking-menu-btn shop" id="btn-station-shop" style="background: linear-gradient(135deg, #f39c12, #e67e22);">ğŸ›’ ìƒì </button>
            <button class="docking-menu-btn interior" id="btn-station-interior">ğŸ  ì •ê±°ì¥ ë‚´ë¶€</button>
        </div>
        
        <!-- â˜…â˜…â˜… ì •ê±°ì¥ ìƒì  ëª¨ë‹¬ â˜…â˜…â˜… -->
        <div id="station-shop-modal" style="
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        ">
            <div style="
                background: linear-gradient(135deg, #0a1628, #1a2d4a);
                border: 2px solid #f39c12;
                border-radius: 20px;
                padding: 30px;
                max-width: 700px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                color: white;
                font-family: 'Orbitron', sans-serif;
            ">
                <h2 style="text-align: center; color: #f39c12; margin-bottom: 25px;">ğŸ›’ ì •ê±°ì¥ ìƒì </h2>
                
                <!-- ë³´ìœ  ì½”ì¸ í‘œì‹œ -->
                <div style="text-align: center; margin-bottom: 20px; font-size: 18px;">
                    ğŸª™ ë³´ìœ  ì½”ì¸: <span id="shop-user-coins" style="color: #f39c12; font-weight: bold;">0</span>
                </div>
                
                <!-- íƒ­ ë©”ë‰´ -->
                <div style="display: flex; gap: 10px; margin-bottom: 20px; justify-content: center;">
                    <button class="shop-tab-btn active" data-tab="telescope" style="padding: 10px 20px; background: #f39c12; color: white; border: none; border-radius: 8px; cursor: pointer;">ğŸ”­ ë§ì›ê²½</button>
                    <button class="shop-tab-btn" data-tab="equipment" style="padding: 10px 20px; background: #333; color: #aaa; border: none; border-radius: 8px; cursor: pointer;">ğŸ› ï¸ ì¥ë¹„</button>
                    <button class="shop-tab-btn" data-tab="consumables" style="padding: 10px 20px; background: #333; color: #aaa; border: none; border-radius: 8px; cursor: pointer;">ğŸ“¦ ì†Œëª¨í’ˆ</button>
                </div>
                
                <!-- ë§ì›ê²½ íƒ­ -->
                <div id="shop-tab-telescope" class="shop-tab-content">
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- ê¸°ë³¸ ë§ì›ê²½ -->
                        <div class="shop-item" data-item="basic" style="
                            background: rgba(46, 204, 113, 0.2);
                            border: 2px solid #2ecc71;
                            border-radius: 12px;
                            padding: 15px;
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        ">
                            <div style="font-size: 40px;">ğŸ”­</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: bold; color: #2ecc71;">ê¸°ë³¸ ë§ì›ê²½</div>
                                <div style="font-size: 12px; color: #aaa;">20ë°° ì¤Œ | ê¸°ë³¸ ì¥ì°©</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #2ecc71; font-weight: bold;">âœ… ë³´ìœ ì¤‘</div>
                                <button class="shop-equip-btn" data-telescope="basic" style="margin-top: 5px; padding: 5px 15px; background: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer;">ì¥ì°©</button>
                            </div>
                        </div>
                        
                        <!-- í‘œì¤€ ë§ì›ê²½ (30x) - ìƒˆë¡œ ì¶”ê°€ -->
                        <div class="shop-item" data-item="standard" style="
                            background: rgba(241, 196, 15, 0.2);
                            border: 2px solid #f1c40f;
                            border-radius: 12px;
                            padding: 15px;
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        ">
                            <div style="font-size: 40px;">ğŸ”­</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: bold; color: #f1c40f;">í‘œì¤€ ë§ì›ê²½</div>
                                <div style="font-size: 12px; color: #aaa;">30ë°° ì¤Œ | í–¥ìƒëœ ì„±ëŠ¥</div>
                            </div>
                            <div id="shop-standard-status" style="text-align: right;">
                                <div style="color: #f39c12; font-weight: bold;">ğŸª™ 2,000</div>
                                <button class="shop-buy-btn" data-telescope="standard" data-price="2000" style="margin-top: 5px; padding: 5px 15px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">êµ¬ë§¤</button>
                            </div>
                        </div>
                        
                        <!-- ê³ ê¸‰ ë§ì›ê²½ -->
                        <div class="shop-item" data-item="advanced" style="
                            background: rgba(52, 152, 219, 0.2);
                            border: 2px solid #3498db;
                            border-radius: 12px;
                            padding: 15px;
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        ">
                            <div style="font-size: 40px;">ğŸ”­</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: bold; color: #3498db;">ê³ ê¸‰ ë§ì›ê²½</div>
                                <div style="font-size: 12px; color: #aaa;">50ë°° ì¤Œ | ì„ ëª…í•œ í™”ì§ˆ</div>
                            </div>
                            <div id="shop-advanced-status" style="text-align: right;">
                                <div style="color: #f39c12; font-weight: bold;">ğŸª™ 5,000</div>
                                <button class="shop-buy-btn" data-telescope="advanced" data-price="5000" style="margin-top: 5px; padding: 5px 15px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">êµ¬ë§¤</button>
                            </div>
                        </div>
                        
                        <!-- ì „ë¬¸ê°€ ë§ì›ê²½ -->
                        <div class="shop-item" data-item="professional" style="
                            background: rgba(155, 89, 182, 0.2);
                            border: 2px solid #9b59b6;
                            border-radius: 12px;
                            padding: 15px;
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        ">
                            <div style="font-size: 40px;">ğŸ”­</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: bold; color: #9b59b6;">ì „ë¬¸ê°€ ë§ì›ê²½</div>
                                <div style="font-size: 12px; color: #aaa;">100ë°° ì¤Œ | ìµœê³  ì„±ëŠ¥</div>
                            </div>
                            <div id="shop-professional-status" style="text-align: right;">
                                <div style="color: #f39c12; font-weight: bold;">ğŸª™ 15,000</div>
                                <button class="shop-buy-btn" data-telescope="professional" data-price="15000" style="margin-top: 5px; padding: 5px 15px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">êµ¬ë§¤</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì¥ë¹„ íƒ­ (ì¤€ë¹„ì¤‘) -->
                <div id="shop-tab-equipment" class="shop-tab-content" style="display: none;">
                    <div style="text-align: center; padding: 40px; color: #888;">
                        <div style="font-size: 50px; margin-bottom: 15px;">ğŸ”§</div>
                        <div data-i18n="equipmentShopPreparing">ì¥ë¹„ ìƒì  ì¤€ë¹„ì¤‘...</div>
                    </div>
                </div>
                
                <!-- ì†Œëª¨í’ˆ íƒ­ (ì¤€ë¹„ì¤‘) -->
                <div id="shop-tab-consumables" class="shop-tab-content" style="display: none;">
                    <div style="text-align: center; padding: 40px; color: #888;">
                        <div style="font-size: 50px; margin-bottom: 15px;">ğŸ“¦</div>
                        <div data-i18n="consumablesShopPreparing">ì†Œëª¨í’ˆ ìƒì  ì¤€ë¹„ì¤‘...</div>
                    </div>
                </div>
                
                <!-- ë‹«ê¸° ë²„íŠ¼ -->
                <button id="btn-close-shop" data-i18n="closeBtn" style="
                    margin-top: 20px;
                    width: 100%;
                    padding: 15px;
                    background: linear-gradient(135deg, #c0392b, #e74c3c);
                    color: white;
                    border: none;
                    border-radius: 10px;
                    font-size: 16px;
                    cursor: pointer;
                ">âœ• ë‹«ê¸°</button>
            </div>
        </div>
        
        <!-- â˜…â˜…â˜… ìˆ˜ë¦¬ ì˜¤ë²„ë ˆì´ â˜…â˜…â˜… -->
        <div id="repair-overlay">
            <div class="repair-title">ğŸ”§ ì„ ì²´ ìˆ˜ë¦¬ ì¤‘...</div>
            <div class="repair-bar-container">
                <div class="repair-bar-fill" id="repair-bar-fill"></div>
            </div>
            <div class="repair-amount" id="repair-amount">0/100</div>
            <div class="repair-cost" id="repair-cost">Cost: 0 coins</div>
        </div>
        
        <!-- â˜…â˜…â˜… ë³´í˜¸ë§‰ ì¶©ëŒ ì´í™íŠ¸ â˜…â˜…â˜… -->
        <div id="shield-impact-overlay"></div>
        
        <!-- â˜… ë„í‚¹í•´ì œ ë²„íŠ¼ -->
        <button id="undock-btn" data-i18n="undock">ğŸš€ Undock</button>
        
        <!-- â˜… ì—°ë£Œ ë³´ê¸‰ ì˜¤ë²„ë ˆì´ -->
        <div id="refuel-overlay">
            <div class="refuel-title" data-i18n="refuelingProgress">â›½ ì—°ë£Œ ë³´ê¸‰ ì¤‘...</div>
            <div class="refuel-bar-container">
                <div class="refuel-bar-fill" id="refuel-bar-fill"></div>
            </div>
            <div class="refuel-amount" id="refuel-amount">0/100</div>
            <div class="refuel-cost" id="refuel-cost">Cost: 0 coins</div>
        </div>
        <div id="pilot-target-select"><select id="ship-target-select"><option value="" data-i18n="navTargetSelect">ğŸ¯ Select Navigation Target...</option></select></div>
        
        <!-- â˜…â˜…â˜… 3D ì¢Œí‘œ í‘œì‹œ íŒ¨ë„ â˜…â˜…â˜… -->
        <div id="pilot-coords-panel">
            <div class="coords-label" data-i18n="currentCoords">ğŸ“ Current Coordinates</div>
            <div class="coords-value" id="pilot-coords-display">X: 0 | Y: 0 | Z: 0</div>
        </div>
        
        <div id="pilot-eta-box">
            <div class="eta-label" data-i18n="eta">ETA</div>
            <div class="eta-time" id="eta-time-display">--:--:--</div>
            <div class="eta-target" id="eta-target-name">Target: ---</div>
        </div>
        <div id="pilot-warning-panel">
            <div class="pilot-warning" id="warn-collision" data-i18n="collisionWarning">âš ï¸ Collision Warning!</div>
            <div class="pilot-warning" id="warn-fuel" data-i18n="lowFuel">âš ï¸ Low Fuel!</div>
            <div class="pilot-warning hull-critical" id="warn-hull" data-i18n="hullDamage">âš ï¸ Hull Damage!</div>
            <div class="pilot-warning caution decel" id="warn-decel" data-i18n="autoDecel">ğŸ”» Auto Deceleration</div>
            <div class="pilot-warning" id="warn-emergency" data-i18n="emergencyReverseWarn">ğŸš¨ Emergency Reverse!</div>
            <div class="pilot-warning gravity" id="warn-gravity" data-i18n="gravityCapture">âš ï¸ Gravity Capture! Escape Required!</div>
            <div class="pilot-warning escape-ready" id="warn-escape-ready" style="display:none;background:rgba(255,153,0,0.3);border-color:#f90;color:#f90;" data-i18n="escapeBoosterReady">âš¡ Escape Booster Ready</div>
        </div>
        <div id="pilot-left" style="display:none;">
            <!-- ALTITUDE ê²Œì´ì§€ ì œê±°ë¨ -->
        </div>
        <div id="pilot-right">
            <div id="pilot-radar"><div class="radar-ring" style="width:30%;height:30%;"></div><div class="radar-ring" style="width:60%;height:60%;"></div><div class="radar-ring" style="width:90%;height:90%;"></div><div id="pilot-radar-sweep"></div><div id="pilot-radar-ship"></div></div>
            <div id="pilot-target-info"><div class="target-label" data-i18n="targetLabel">TARGET</div><div class="target-name" id="pilot-target-name" data-i18n="none">None</div><div class="target-dist" id="pilot-target-dist">---</div><div class="target-eta" id="pilot-target-eta"></div></div>
            <div id="pilot-autopilot-info" class="inactive"><div class="ap-label" data-i18n="autopilotLabel">AUTOPILOT</div><div class="ap-status" id="ap-status" data-i18n="off">OFF</div><div class="ap-phase" id="ap-phase"></div></div>
        </div>
        <div id="crosshair"><div class="ch-line h"></div><div class="ch-line v"></div><div class="ch-dot"></div></div>
        
        <!-- â˜… í†µí•© ì±„íŒ… íŒ¨ë„ (ARIA + ë©€í‹°ì±„íŒ…) -->
        <div id="unified-chat-panel">
            <div class="chat-tab-bar">
                <button class="chat-tab active" data-tab="aria" data-i18n="ariaTab">ğŸ¤– ARIA</button>
                <button class="chat-tab" data-tab="multi" data-i18n="chatTab">ğŸ’¬ Chat</button>
                <button id="chat-toggle-btn">â–¼</button>
            </div>
            <div class="chat-content">
                <!-- ARIA íƒ­ -->
                <div id="aria-tab" class="tab-content active">
                    <div class="chat-content-box" id="aria-messages">
                        <div class="aria-msg"><span class="aria-text" data-i18n="systemInit">System initialized. Fly safe, pilot.</span></div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="aria-input" data-placeholder-i18n="ariaPlaceholder" placeholder="ARIAì—ê²Œ ì§ˆë¬¸..." maxlength="200">
                        <button id="aria-send-btn">â–¶</button>
                    </div>
                </div>
                <!-- ë©€í‹° ì±„íŒ… íƒ­ -->
                <div id="multi-tab" class="tab-content">
                    <div class="chat-content-box" id="multi-messages">
                        <div class="mp-msg system" data-i18n="chatNotConnected">Not connected to chat</div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="multi-input" data-placeholder-i18n="enterMessage" placeholder="ë©”ì‹œì§€ ì…ë ¥..." maxlength="200">
                        <button id="multi-send-btn">â–¶</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI ë¶€ì¡°ì¢…ì‚¬ íŒ¨ë„ (ìˆ¨ê¹€) -->
        <div id="ai-copilot-panel">
            <div id="ai-copilot-header">
                <div id="ai-avatar">ğŸ¤–</div>
                <div>
                    <div id="ai-name">ARIA</div>
                    <div id="ai-status" data-i18n="online">â— ì˜¨ë¼ì¸</div>
                </div>
                <button id="ai-expand-btn" onclick="toggleAIPanel()">â–¼</button>
            </div>
            <div id="ai-message-box">
                <span id="ai-message-text" data-i18n="aiInitMessage">ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ. ì•ˆì „í•œ ë¹„í–‰ ë˜ì„¸ìš”, íŒŒì¼ëŸ¿.</span>
            </div>
            <div id="ai-input-area">
                <input type="text" id="ai-input" placeholder="ARIAì—ê²Œ ì§ˆë¬¸í•˜ê¸°..." data-placeholder-i18n="ariaPlaceholder" maxlength="200">
                <button id="ai-send-btn" onclick="aiSendQuestion()">â–¶</button>
            </div>
        </div>
        
        <!-- AI êµì‹  ëª¨ë‹¬ -->
        <div id="ai-comm-modal">
            <div id="ai-comm-portrait">ğŸ‘½</div>
            <div id="ai-comm-name" data-i18n="unidentifiedSignal">ë¯¸í™•ì¸ ì‹ í˜¸</div>
            <div id="ai-comm-message"></div>
            <div id="ai-comm-choices"></div>
        </div>
        
        <div id="pilot-bottom">
            <div id="pilot-left-console">
                <div class="vertical-gauge thr-gauge">
                    <div class="thr-label-top" data-i18n="accel">ê°€ì†</div>
                    <div class="vg-bar thr-bar">
                        <div class="vg-bg">
                            <div class="thr-center-line"></div>
                            <div class="vg-fill throttle-up" id="throttle-up-fill"></div>
                            <div class="vg-fill throttle-down" id="throttle-down-fill"></div>
                        </div>
                    </div>
                    <div class="thr-label-bottom" data-i18n="reverse">ì—­ì¶”ì§„</div>
                    <div class="vg-label">THR</div>
                    <div class="vg-value" id="throttle-val">0%</div>
                </div>
                <div class="vertical-gauge"><div class="vg-bar"><div class="vg-bg"><div class="vg-fill fuel" id="fuel-fill"></div></div></div><div class="vg-label">FUEL</div><div class="vg-value" id="fuel-val">100/100</div></div>
                <div class="vertical-gauge hull-gauge"><div class="vg-bar"><div class="vg-bg"><div class="vg-fill hull" id="hull-fill" style="height:100%;background:linear-gradient(180deg,#ff8800,#ff4400);"></div></div></div><div class="vg-label" style="color:#ff8800;">HULL</div><div class="vg-value" id="hull-val" style="color:#ff8800;">100</div></div>
                <!-- ê¸´ê¸‰ ì—­ì¶”ì§„ ë²„íŠ¼ -->
                <button class="pilot-ctrl-btn emergency-brake" id="btn-emergency-brake" data-i18n="emergencyReverse">ğŸ”¥<br>ê¸´ê¸‰ì—­ì¶”ì§„</button>
            </div>
            <div id="pilot-center-console">
                <div id="pilot-main-speed">
                    <span class="speed-value" id="main-speed-val">0</span><span class="speed-unit">km/s</span>
                    <div id="speed-kmh" style="font-size:0.6em;color:#aaa;margin-top:2px;">(0 km/h)</div>
                </div>
                <div id="pilot-btn-row">
                    <button class="pilot-console-btn autopilot" id="btn-autopilot" data-i18n="auto">ğŸ¤– Auto</button>
                    <button class="pilot-console-btn orbit-entry" id="btn-orbit-entry" style="display:none;" data-i18n="orbitEntry">ğŸŒ Orbit</button>
                    <button class="pilot-console-btn interior disabled" id="btn-interior" data-i18n="interior">ğŸšª Interior</button>
                    <button class="pilot-console-btn" id="btn-telescope" style="background:linear-gradient(135deg,#1a5276,#2980b9);" data-i18n="telescope">ğŸ”­ Telescope</button>
                    <button class="pilot-console-btn emergency" id="btn-escape" data-i18n="emergency">ğŸ†˜ Escape</button>
                    <button class="pilot-console-btn danger" id="btn-exit-pilot" style="padding:5px 8px; font-size:8px;" data-i18n="disembark">ğŸŒŒ Exit</button>
                </div>
            </div>
            <div id="pilot-right-console">
                <!-- ë°ìŠ¤í¬í†±ìš© ê°€ì†/ê°ì† ë²„íŠ¼ -->
                <button class="pilot-ctrl-btn desktop-only" id="btn-accel">â–²</button>
                <button class="pilot-ctrl-btn desktop-only" id="btn-decel">â–¼</button>
            </div>
        </div>
        <div id="virtual-joystick"><div id="joystick-base"><div id="joystick-knob"></div></div></div>
        
        <!-- 3ì¸ì¹­ ë·° ì „ìš© í”Œë¡œíŒ… ë²„íŠ¼ (ë¹„í™œì„±í™” - ì¡°ì¢…ì‹¤ UI ì‚¬ìš©) -->
        <div id="space-view-controls" style="display:none !important;"></div>
        
        <!-- í„°ì¹˜ ì˜ì—­ (í™”ë©´ ì™¼ìª½ ì ˆë°˜) -->
        <div id="touch-area-left"></div>
        
        <!-- ëª¨ë°”ì¼ìš© ë™ì  ì¡°ì´ìŠ¤í‹± -->
        <div id="pilot-joystick">
            <div id="pilot-joystick-base">
                <div id="pilot-joystick-knob"></div>
            </div>
        </div>
        
        <!-- ê¶¤ë„ ì§„ì… í”„ë¡¬í”„íŠ¸ -->
        <div id="orbit-prompt">
            <div class="orbit-prompt-title" data-i18n="orbitLock">ğŸŒ Tidal Lock Orbit</div>
            <div class="orbit-prompt-target"><span id="orbit-target-name">Earth</span> <span data-i18n="stableOrbit">Stable Orbit</span></div>
            <p data-i18n="orbitPromptMsg">Enter tidal locked orbit?<br>Ship will naturally orbit while facing the planet.</p>
            <div class="orbit-prompt-buttons">
                <button class="orbit-btn confirm" id="btn-enter-orbit" data-i18n="confirmOrbit">âœ“ Lock Orbit</button>
                <button class="orbit-btn cancel" id="btn-cancel-orbit" data-i18n="cancel">âœ• Cancel</button>
            </div>
        </div>
    </div>

    <!-- ì„ ë‚´ HUD -->
    <div id="interior-hud">
        <div id="interior-top">
            <span id="interior-location">ğŸ“ Cockpit</span>
            <span id="interior-eta">â±ï¸ --:--:--</span>
        </div>
        <div id="move-joystick"><div id="move-joystick-base"><div id="move-joystick-knob"></div></div></div>
        <div id="interior-crosshair"></div>
        <div id="object-name"></div>
        <div id="interaction-hint">[E] ìƒí˜¸ì‘ìš©</div>
        <div id="interior-bottom"><button class="pilot-console-btn" id="btn-int-back">â† ì¡°ì¢…ì„</button></div>
        <div id="door-prompt"><div class="door-name" id="door-name" data-i18n="researchLab">ğŸšª ì—°êµ¬ì‹¤</div><p data-i18n="approachedDoor">ë¬¸ì— ì ‘ê·¼í–ˆìŠµë‹ˆë‹¤</p><button id="btn-open-door" data-i18n="enterDoor">ì…ì¥ [E]</button></div>
    </div>

    <!-- ì „ë§ëŒ€ HUD -->
    <div id="observatory-hud">
        <div id="obs-top">
            <span id="obs-title" data-i18n="observatory">ğŸ”­ Observatory</span>
            <span id="obs-eta">â±ï¸ --:--:--</span>
        </div>
        <div id="obs-bottom"><button class="pilot-console-btn" id="btn-obs-back">â† Return to Interior</button></div>
    </div>

    <!-- ëª¨ë°”ì¼ ë¯¸ë‹ˆ HUD -->
    <div id="mobile-mini-hud" style="display: none;">
        <div class="mini-hud-item">
            <span class="mini-hud-icon">ğŸš€</span>
            <span class="mini-hud-value" id="mini-speed">0</span>
            <span style="color:#888;font-size:10px;">km/s</span>
        </div>
        <div class="mini-hud-item">
            <div class="mini-hud-bar">
                <div class="mini-hud-bar-fill" id="mini-fuel-bar" style="width: 100%;"></div>
            </div>
            <span class="mini-hud-value" id="mini-fuel">100/100</span>
        </div>
        <div class="mini-hud-item">
            <span class="mini-hud-icon">ğŸ¯</span>
            <span class="mini-hud-value" id="mini-target" style="font-size:10px;" data-i18n="none">None</span>
        </div>
    </div>

    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ íƒ­ ë°” -->
    <div id="mobile-tab-bar">
        <button class="mobile-tab active" data-tab="control">
            <span class="mobile-tab-icon">ğŸ•¹ï¸</span>
            <span data-i18n="control">ì¡°ì¢…</span>
        </button>
        <button class="mobile-tab" data-tab="status">
            <span class="mobile-tab-icon">ğŸ“Š</span>
            <span data-i18n="statusTab">ìƒíƒœ</span>
        </button>
        <button class="mobile-tab" data-tab="radio">
            <span class="mobile-tab-icon">ğŸ“»</span>
            <span data-i18n="radioTab">ë¼ë””ì˜¤</span>
        </button>
        <button class="mobile-tab" data-tab="chat">
            <span class="mobile-tab-icon">ğŸ’¬</span>
            <span data-i18n="chatTab2">ì±„íŒ…</span>
        </button>
        <button class="mobile-tab" data-tab="aria">
            <span class="mobile-tab-icon">ğŸ¤–</span>
            <span data-i18n="ariaTab2">ARIA</span>
        </button>
    </div>

    <!-- ëª¨ë°”ì¼ íƒ­ íŒ¨ë„ -->
    <div id="mobile-tab-panel">
        <!-- ì¡°ì¢… íŒ¨ë„ -->
        <div class="mobile-panel-content active" id="mobile-control-panel">
            <div class="mobile-gauge-group" id="mobile-gauge-container">
                <div class="mobile-gauge">
                    <span class="mobile-gauge-label">THR</span>
                    <div class="mobile-gauge-bar">
                        <div class="mobile-gauge-fill thr" id="mobile-thr-fill" style="height: 50%;"></div>
                    </div>
                    <span class="mobile-gauge-value" id="mobile-thr-value">+0%</span>
                </div>
                <div class="mobile-gauge">
                    <span class="mobile-gauge-label">FUEL</span>
                    <div class="mobile-gauge-bar">
                        <div class="mobile-gauge-fill fuel" id="mobile-fuel-fill" style="height: 100%;"></div>
                    </div>
                    <span class="mobile-gauge-value" id="mobile-fuel-value">100/100</span>
                </div>
                <div class="mobile-gauge">
                    <span class="mobile-gauge-label" style="color:#ff8800;">HULL</span>
                    <div class="mobile-gauge-bar" style="border-color:#ff8800;">
                        <div class="mobile-gauge-fill" id="mobile-hull-fill" style="height: 100%;background:linear-gradient(180deg,#ff8800,#ff4400);"></div>
                    </div>
                    <span class="mobile-gauge-value" id="mobile-hull-value" style="color:#ff8800;">100</span>
                </div>
            </div>
            
            <div class="mobile-speed-display" id="mobile-speed-container">
                <div class="mobile-speed-value" id="mobile-speed-val">0</div>
                <div class="mobile-speed-unit">km/s</div>
                <div class="mobile-speed-secondary" id="mobile-speed-kmh">(0 km/h)</div>
            </div>
            
            <div class="mobile-direction-btns" id="mobile-arrows-container">
                <button class="mobile-dir-btn" id="mobile-accel">â–²</button>
                <button class="mobile-dir-btn emergency-brake" id="mobile-emergency-brake" style="background:linear-gradient(145deg,#cc0000,#990000);border-color:#ff3333;">ğŸ”¥</button>
                <button class="mobile-dir-btn" id="mobile-decel">â–¼</button>
            </div>
            
            <div class="mobile-btn-row" id="mobile-btns-container">
                <button class="mobile-action-btn autopilot" id="mobile-autopilot">ğŸ¤– Auto</button>
                <button class="mobile-action-btn" id="mobile-guide">ğŸ“ Guide</button>
                <button class="mobile-action-btn orbit" id="mobile-orbit" style="display:none; background: linear-gradient(135deg, #2ecc71, #27ae60);">ğŸŒ Orbit</button>
                <button class="mobile-action-btn" id="mobile-telescope">ğŸ”­ Scope</button>
                <button class="mobile-action-btn" id="mobile-space-mode" style="padding:6px 10px; font-size:11px;">ğŸŒŒ Space</button>
            </div>
        </div>

        <!-- â˜… ë¬´ê¸° ë°œì‚¬ ë²„íŠ¼ -->
        <button id="mobile-fire-btn">ğŸ”¥</button>

        <!-- â˜… í”¼ê²© í”Œë˜ì‹œ ì˜¤ë²„ë ˆì´ -->
        <div id="weapon-hit-overlay"></div>

        <!-- ìƒíƒœ íŒ¨ë„ -->
        <div class="mobile-panel-content" id="mobile-status-panel">
            <div class="mobile-status-item">
                <div class="mobile-status-label">Speed</div>
                <div class="mobile-status-value" id="mobile-stat-speed">0 km/s</div>
            </div>
            <div class="mobile-status-item">
                <div class="mobile-status-label">Fuel</div>
                <div class="mobile-status-value" id="mobile-stat-fuel">100/100</div>
            </div>
            <div class="mobile-status-item">
                <div class="mobile-status-label">Target</div>
                <div class="mobile-status-value" id="mobile-stat-target">None</div>
            </div>
            <div class="mobile-status-item">
                <div class="mobile-status-label">Distance</div>
                <div class="mobile-status-value" id="mobile-stat-distance">-</div>
            </div>
            <div class="mobile-status-item">
                <div class="mobile-status-label">Autopilot</div>
                <div class="mobile-status-value" id="mobile-stat-autopilot">OFF</div>
            </div>
            <div class="mobile-status-item">
                <div class="mobile-status-label">Location</div>
                <div class="mobile-status-value" id="mobile-stat-location">Solar System</div>
            </div>
        </div>
        
        <!-- ë¼ë””ì˜¤ íŒ¨ë„ -->
        <div class="mobile-panel-content" id="mobile-radio-panel">
            <div class="mobile-radio-station" data-url="https://ice.somafm.com/spacestation" data-name="Space Station">
                <span class="mobile-radio-name" data-i18n="spaceStation">ğŸš€ ìš°ì£¼ ì •ê±°ì¥</span>
                <span class="mobile-radio-status">Ambient</span>
            </div>
            <div class="mobile-radio-station" data-url="https://ice.somafm.com/deepspaceone" data-name="Deep Space One">
                <span class="mobile-radio-name">ğŸŒŒ Deep Space One</span>
                <span class="mobile-radio-status">Space Music</span>
            </div>
            <div class="mobile-radio-station" data-url="https://ice.somafm.com/dronezone" data-name="Drone Zone">
                <span class="mobile-radio-name">ğŸ§ Drone Zone</span>
                <span class="mobile-radio-status">Atmospheric</span>
            </div>
            <div class="mobile-radio-station" data-url="https://ice.somafm.com/groovesalad" data-name="Groove Salad">
                <span class="mobile-radio-name">ğŸ¥— Groove Salad</span>
                <span class="mobile-radio-status">Downtempo</span>
            </div>
            <div class="mobile-radio-volume">
                <span>ğŸ”Š</span>
                <input type="range" id="mobile-radio-vol" min="0" max="100" value="30">
                <span id="mobile-radio-vol-val">30%</span>
            </div>
        </div>
        
        <!-- ì±„íŒ… íŒ¨ë„ -->
        <div class="mobile-panel-content" id="mobile-chat-panel">
            <div class="mobile-chat-messages" id="mobile-chat-messages">
                <div style="color:#888;text-align:center;">ì±„íŒ… ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
            </div>
            <div class="mobile-chat-input-row">
                <input type="text" id="mobile-chat-input" placeholder="ë©”ì‹œì§€ ì…ë ¥..." data-placeholder-i18n="enterMessage" maxlength="100">
                <button id="mobile-chat-send" data-i18n="send">ì „ì†¡</button>
            </div>
        </div>
        
        <!-- ARIA íŒ¨ë„ -->
        <div class="mobile-panel-content" id="mobile-aria-panel">
            <div class="mobile-aria-header">
                <div class="mobile-aria-avatar">ğŸ¤–</div>
                <div class="mobile-aria-info">
                    <div class="mobile-aria-name">ARIA</div>
                    <div class="mobile-aria-status" data-i18n="online">â— ì˜¨ë¼ì¸</div>
                </div>
            </div>
            <div class="mobile-aria-messages" id="mobile-aria-messages">
                ì•ˆë…•í•˜ì„¸ìš”, íŒŒì¼ëŸ¿! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”? ğŸš€
            </div>
            <div class="mobile-aria-input-row">
                <input type="text" id="mobile-aria-input" placeholder="ARIAì—ê²Œ ì§ˆë¬¸..." data-placeholder-i18n="ariaPlaceholder" maxlength="100">
                <button id="mobile-aria-send">â–¶</button>
            </div>
        </div>
    </div>

    <script id="vertexShader" type="x-shader/x-vertex">
        #include <common>
        #include <logdepthbuf_pars_vertex>
        varying vec2 vUv;
        varying vec3 vPosition;
        void main() {
            vUv = uv;
            vPosition = position;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            #include <logdepthbuf_vertex>
        }
    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">
        #include <common>
        #include <logdepthbuf_pars_fragment>
        uniform float time;
        varying vec2 vUv;
        varying vec3 vPosition;

        vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
        vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}
        float snoise(vec3 v){ 
            const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
            const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
            vec3 i  = floor(v + dot(v, C.yyy) );
            vec3 x0 = v - i + dot(i, C.xxx) ;
            vec3 g = step(x0.yzx, x0.xyz);
            vec3 l = 1.0 - g;
            vec3 i1 = min( g.xyz, l.zxy );
            vec3 i2 = max( g.xyz, l.zxy );
            vec3 x1 = x0 - i1 + 1.0 * C.xxx;
            vec3 x2 = x0 - i2 + 2.0 * C.xxx;
            vec3 x3 = x0 - 1.0 + 3.0 * C.xxx;
            i = mod(i, 289.0 ); 
            vec4 p = permute( permute( permute( 
                        i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
                    + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
                    + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
            float n_ = 1.0/7.0; // N=7
            vec3  ns = n_ * D.wyz - D.xzx;
            vec4 j = p - 49.0 * floor(p * ns.z *ns.z);
            vec4 x_ = floor(j * ns.z);
            vec4 y_ = floor(j - 7.0 * x_ );
            vec4 x = x_ *ns.x + ns.yyyy;
            vec4 y = y_ *ns.x + ns.yyyy;
            vec4 h = 1.0 - abs(x) - abs(y);
            vec4 b0 = vec4( x.xy, y.xy );
            vec4 b1 = vec4( x.zw, y.zw );
            vec4 s0 = floor(b0)*2.0 + 1.0;
            vec4 s1 = floor(b1)*2.0 + 1.0;
            vec4 sh = -step(h, vec4(0.0));
            vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
            vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
            vec3 p0 = vec3(a0.xy,h.x);
            vec3 p1 = vec3(a0.zw,h.y);
            vec3 p2 = vec3(a1.xy,h.z);
            vec3 p3 = vec3(a1.zw,h.w);
            vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
            p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w;
            vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
            m = m * m;
            return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );
        }

        void main() {
            #include <logdepthbuf_fragment>
            float noiseVal = snoise(vPosition * 1.65 + vec3(time * 0.2));
            float noiseVal2 = snoise(vPosition * 3.3 - vec3(time * 0.3));
            float intensity = (noiseVal * 0.6 + noiseVal2 * 0.4) + 0.3;
            vec3 darkColor = vec3(1.0, 0.4, 0.0); 
            vec3 baseColor = vec3(1.0, 0.7, 0.0); 
            vec3 brightColor = vec3(1.0, 1.0, 0.9);
            vec3 finalColor = mix(darkColor, baseColor, intensity + 0.2);
            finalColor = mix(finalColor, brightColor, smoothstep(0.4, 0.8, intensity));
            gl_FragColor = vec4(finalColor, 1.0);
        }
    </script>

    <script id="coronaVertexShader" type="x-shader/x-vertex">
        #include <common>
        #include <logdepthbuf_pars_vertex>
        varying vec2 vUv;
        void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            #include <logdepthbuf_vertex>
        }
    </script>

    <script id="coronaFragmentShader" type="x-shader/x-fragment">
        #include <common>
        #include <logdepthbuf_pars_fragment>
        uniform float time;
        varying vec2 vUv;
        float random(vec2 n) { return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453); }
        float noise(vec2 p){
            vec2 ip = floor(p);
            vec2 u = fract(p);
            u = u*u*(3.0-2.0*u);
            float res = mix(
                mix(random(ip), random(ip+vec2(1.0,0.0)), u.x),
                mix(random(ip+vec2(0.0,1.0)), random(ip+vec2(1.0,1.0)), u.x), u.y);
            return res*res;
        }
        void main() {
            #include <logdepthbuf_fragment>
            vec2 center = vec2(0.5, 0.5);
            vec2 pos = vUv - center;
            float r = length(pos);
            float angle = atan(pos.y, pos.x);
            float rays = noise(vec2(angle * 10.0 + time * 0.1, r * 2.0 - time * 0.5));
            rays += noise(vec2(angle * 20.0 - time * 0.2, r * 5.0 + time * 0.2)) * 0.5;
            float glow = 1.0 - smoothstep(0.0, 0.5, r);
            glow = pow(glow, 3.0); 
            float rayIntensity = glow * (0.8 + 0.4 * rays);
            vec3 coronaColor = vec3(1.0, 0.6, 0.2); 
            gl_FragColor = vec4(coronaColor, rayIntensity * 0.8);
        }
    </script>

    <!-- â˜…â˜…â˜… ì§€êµ¬ ëŒ€ê¸° ì‰ì´ë” (ë ˆì¼ë¦¬ + ë¯¸ ì‚°ë€) â˜…â˜…â˜… -->
    <script id="atmosphereVertexShader" type="x-shader/x-vertex">
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec3 vWorldPosition;
        
        void main() {
            vNormal = normalize(normalMatrix * normal);
            vPosition = position;
            vec4 worldPos = modelMatrix * vec4(position, 1.0);
            vWorldPosition = worldPos.xyz;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    </script>
    
    <script id="atmosphereFragmentShader" type="x-shader/x-fragment">
        uniform vec3 sunDirection;
        uniform float atmosphereRadius;
        uniform float planetRadius;
        uniform float time;
        
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec3 vWorldPosition;
        
        // ë ˆì¼ë¦¬ ì‚°ë€ ê³„ìˆ˜ (íŒŒì¥ë³„ - í‘¸ë¥¸ìƒ‰ì´ ë” ë§ì´ ì‚°ë€)
        const vec3 rayleighCoeff = vec3(5.8e-6, 13.5e-6, 33.1e-6);
        // ë¯¸ ì‚°ë€ ê³„ìˆ˜ (ëª¨ë“  íŒŒì¥ì—ì„œ ë™ì¼ - í°ìƒ‰ ì‚°ë€)
        const float mieCoeff = 21e-6;
        
        // ëŒ€ê¸° ë°€ë„ í•¨ìˆ˜ (ê³ ë„ì— ë”°ë¥¸ ì§€ìˆ˜ ê°ì†Œ)
        float atmosphereDensity(float altitude) {
            float scaleHeight = 8500.0; // ìŠ¤ì¼€ì¼ ë†’ì´ 8.5km
            return exp(-altitude / scaleHeight);
        }
        
        void main() {
            vec3 viewDir = normalize(cameraPosition - vWorldPosition);
            vec3 normal = normalize(vNormal);
            
            // í”„ë ˆë„¬ íš¨ê³¼ (ê°€ì¥ìë¦¬ì—ì„œ ë” ê°•í•˜ê²Œ)
            float fresnel = pow(1.0 - max(dot(viewDir, normal), 0.0), 3.0);
            
            // íƒœì–‘ ë°©í–¥ê³¼ì˜ ê°ë„
            float sunAngle = max(dot(normal, sunDirection), 0.0);
            
            // ë ˆì¼ë¦¬ ì‚°ë€ (í‘¸ë¥¸ í•˜ëŠ˜)
            vec3 rayleigh = rayleighCoeff * (1.0 + pow(sunAngle, 2.0));
            
            // ë¯¸ ì‚°ë€ (íƒœì–‘ ì£¼ë³€ ë°ì€ ê¸€ë¡œìš°)
            float miePhase = pow(max(dot(viewDir, sunDirection), 0.0), 8.0);
            vec3 mie = vec3(mieCoeff) * miePhase;
            
            // ëŒ€ê¸° ìƒ‰ìƒ ê³„ì‚°
            vec3 dayColor = vec3(0.3, 0.6, 1.0);   // ë‚®: í‘¸ë¥¸ìƒ‰
            vec3 sunsetColor = vec3(1.0, 0.4, 0.1); // ì¼ëª°: ì£¼í™©ìƒ‰
            vec3 nightColor = vec3(0.02, 0.02, 0.05); // ë°¤: ì–´ë‘ìš´ íŒŒë‘
            
            // ì¼ëª° íš¨ê³¼ (íƒœì–‘ì´ ìˆ˜í‰ì„ ì— ê°€ê¹Œìš¸ ë•Œ)
            float horizonAngle = dot(normal, sunDirection);
            float sunsetFactor = smoothstep(-0.1, 0.3, horizonAngle) * smoothstep(0.5, 0.1, horizonAngle);
            
            // ë‚®/ë°¤ í˜¼í•©
            float dayFactor = smoothstep(-0.1, 0.2, sunAngle);
            vec3 baseColor = mix(nightColor, dayColor, dayFactor);
            baseColor = mix(baseColor, sunsetColor, sunsetFactor * 0.7);
            
            // ìµœì¢… ëŒ€ê¸° ìƒ‰ìƒ
            vec3 atmosphere = baseColor * fresnel * 1.5;
            atmosphere += mie * vec3(1.0, 0.9, 0.7) * 2.0;  // íƒœì–‘ ê¸€ë¡œìš°
            
            // íˆ¬ëª…ë„ (ê°€ì¥ìë¦¬ì—ì„œ ë” ë¶ˆíˆ¬ëª…)
            float alpha = fresnel * 0.8 + sunsetFactor * 0.2;
            alpha = clamp(alpha, 0.0, 0.85);
            
            gl_FragColor = vec4(atmosphere, alpha);
        }
    </script>
    
    <!-- â˜…â˜…â˜… ì§€êµ¬ êµ¬ë¦„ ì‰ì´ë” (ë³¼ë¥˜ë©”íŠ¸ë¦­ ë ˆì´ë§ˆì¹­) â˜…â˜…â˜… -->
    <script id="cloudVertexShader" type="x-shader/x-vertex">
        varying vec2 vUv;
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec3 vWorldPosition;
        varying vec3 vViewDir;
        
        void main() {
            vUv = uv;
            vNormal = normalize(normalMatrix * normal);
            vPosition = position;
            vec4 worldPos = modelMatrix * vec4(position, 1.0);
            vWorldPosition = worldPos.xyz;
            vViewDir = normalize(cameraPosition - worldPos.xyz);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    </script>
    
    <script id="cloudFragmentShader" type="x-shader/x-fragment">
        uniform float time;
        uniform vec3 sunDirection;
        uniform float cloudDensity;
        uniform float cloudSpeed;
        
        varying vec2 vUv;
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec3 vWorldPosition;
        varying vec3 vViewDir;
        
        // í•´ì‹œ í•¨ìˆ˜
        float hash(vec3 p) {
            p = fract(p * 0.3183099 + 0.1);
            p *= 17.0;
            return fract(p.x * p.y * p.z * (p.x + p.y + p.z));
        }
        
        // 3D ë…¸ì´ì¦ˆ
        float noise(vec3 x) {
            vec3 i = floor(x);
            vec3 f = fract(x);
            f = f * f * (3.0 - 2.0 * f);
            
            return mix(mix(mix(hash(i + vec3(0,0,0)), hash(i + vec3(1,0,0)), f.x),
                          mix(hash(i + vec3(0,1,0)), hash(i + vec3(1,1,0)), f.x), f.y),
                      mix(mix(hash(i + vec3(0,0,1)), hash(i + vec3(1,0,1)), f.x),
                          mix(hash(i + vec3(0,1,1)), hash(i + vec3(1,1,1)), f.x), f.y), f.z);
        }
        
        // ì›Œí•‘ëœ FBM - ë” ìì—°ìŠ¤ëŸ¬ìš´ êµ¬ë¦„ í˜•íƒœ
        float fbm(vec3 p) {
            float value = 0.0;
            float amplitude = 0.5;
            float frequency = 1.0;
            
            // ì›Œí•‘ (êµ¬ë¦„ì´ íœ˜ì–´ì§€ëŠ” íš¨ê³¼)
            p += vec3(noise(p * 2.0), noise(p * 2.0 + 100.0), noise(p * 2.0 + 200.0)) * 0.5;
            
            for (int i = 0; i < 6; i++) {
                value += amplitude * noise(p * frequency);
                amplitude *= 0.5;
                frequency *= 2.0;
                // ê° ë ˆì´ì–´ë§ˆë‹¤ ì•½ê°„ì”© íšŒì „ (ë” ìì—°ìŠ¤ëŸ¬ì›€)
                p = p.yzx * 1.01;
            }
            return value;
        }
        
        // êµ¬ë¦„ ë°€ë„ ìƒ˜í”Œë§
        float sampleCloud(vec3 pos, float t) {
            // ì‹œê°„ì— ë”°ë¥¸ ë°”ëŒ íš¨ê³¼
            vec3 windOffset = vec3(t * 0.02, 0.0, t * 0.01);
            
            // ê¸°ë³¸ êµ¬ë¦„ ë…¸ì´ì¦ˆ
            float cloud = fbm((pos + windOffset) * 3.0);
            
            // ì„¸ë¶€ ë…¸ì´ì¦ˆ ì¶”ê°€
            cloud += fbm((pos + windOffset * 2.0) * 8.0) * 0.3;
            cloud += fbm((pos + windOffset * 3.0) * 16.0) * 0.15;
            
            // ìœ„ë„ì— ë”°ë¥¸ êµ¬ë¦„ ë¶„í¬ (ì ë„ì™€ ì¤‘ìœ„ë„ì— ë” ë§ì´)
            float latitude = abs(pos.y);
            float latMask = smoothstep(0.9, 0.6, latitude) * smoothstep(0.0, 0.2, latitude);
            latMask = mix(latMask, 1.0, 0.4);  // ì™„ì „íˆ ì—†ì–´ì§€ì§€ ì•Šë„ë¡
            
            // êµ¬ë¦„ í˜•íƒœ ì¡°ì ˆ
            cloud = cloud * latMask;
            cloud = smoothstep(0.35, 0.65, cloud);  // êµ¬ë¦„ ê²½ê³„ ì„ ëª…í•˜ê²Œ
            
            return cloud;
        }
        
        void main() {
            vec3 normal = normalize(vNormal);
            vec3 viewDir = normalize(vViewDir);
            
            // êµ¬ë©´ ì¢Œí‘œ
            vec3 spherePos = normalize(vPosition);
            
            // ë ˆì´ë§ˆì¹­ ì„¤ì •
            const int STEPS = 8;
            float stepSize = 0.02;
            
            vec3 rayPos = spherePos;
            float totalDensity = 0.0;
            float transmittance = 1.0;
            vec3 cloudColor = vec3(0.0);
            
            // íƒœì–‘ ì¡°ëª…
            float sunLight = max(dot(normal, sunDirection), 0.0);
            float sunsetFactor = smoothstep(-0.1, 0.3, sunLight) * smoothstep(0.5, 0.1, sunLight);
            
            // ê¸°ë³¸ êµ¬ë¦„ ìƒ‰ìƒ
            vec3 dayColor = vec3(1.0, 1.0, 1.0);
            vec3 sunsetColor = vec3(1.0, 0.6, 0.4);
            vec3 nightColor = vec3(0.2, 0.2, 0.25);
            
            vec3 baseColor = mix(nightColor, dayColor, smoothstep(-0.1, 0.3, sunLight));
            baseColor = mix(baseColor, sunsetColor, sunsetFactor * 0.7);
            
            // ê°„ë‹¨í•œ ë ˆì´ë§ˆì¹­ (ì—¬ëŸ¬ ë ˆì´ì–´ ìƒ˜í”Œë§)
            for (int i = 0; i < STEPS; i++) {
                float fi = float(i) / float(STEPS);
                
                // ë†’ì´ì— ë”°ë¥¸ ë ˆì´ì–´
                vec3 samplePos = spherePos * (1.0 + fi * 0.03);
                
                // êµ¬ë¦„ ë°€ë„ ìƒ˜í”Œë§
                float density = sampleCloud(samplePos, time);
                
                if (density > 0.01) {
                    // ë¼ì´íŠ¸ ì‚°ë€ (íƒœì–‘ ë°©í–¥ì—ì„œ ë” ë°ê²Œ)
                    float lightScatter = 0.5 + 0.5 * max(dot(samplePos, sunDirection), 0.0);
                    
                    // ê·¸ë¦¼ì íš¨ê³¼ (ìœ„ ë ˆì´ì–´ê°€ ì•„ë˜ë¥¼ ê°€ë¦¼)
                    float shadow = 1.0 - fi * 0.3;
                    
                    // ìƒ‰ìƒ ëˆ„ì 
                    vec3 stepColor = baseColor * lightScatter * shadow;
                    
                    // ì€ì„  íš¨ê³¼ (Silver Lining) - êµ¬ë¦„ ê°€ì¥ìë¦¬ê°€ ë°ê²Œ
                    float edge = smoothstep(0.3, 0.5, density) - smoothstep(0.5, 0.7, density);
                    stepColor += vec3(1.0, 0.95, 0.9) * edge * sunLight * 0.5;
                    
                    cloudColor += stepColor * density * transmittance;
                    transmittance *= 1.0 - density * 0.3;
                }
            }
            
            // í”„ë ˆë„¬ íš¨ê³¼ (ê°€ì¥ìë¦¬ì—ì„œ ë” íˆ¬ëª…)
            float fresnel = pow(1.0 - max(dot(viewDir, normal), 0.0), 2.0);
            float alpha = totalDensity;
            
            // ë ˆì´ë§ˆì¹­ ê²°ê³¼ë¡œ ì•ŒíŒŒ ê³„ì‚°
            alpha = 1.0 - transmittance;
            alpha = clamp(alpha * 1.5, 0.0, 0.9);
            
            // ë°¤ì—ëŠ” êµ¬ë¦„ì´ ëœ ë³´ì´ë„ë¡
            alpha *= mix(0.4, 1.0, smoothstep(-0.2, 0.1, sunLight));
            
            // ê°€ì¥ìë¦¬ í˜ì´ë“œ
            alpha *= smoothstep(0.0, 0.3, 1.0 - fresnel * 0.5);
            
            gl_FragColor = vec4(cloudColor / max(1.0 - transmittance, 0.001), alpha);
        }
    </script>

    <script type="module" src="js/main.js"></script>

<script src="js/multiplayer.js"></script>
<script src="js/systems.js"></script>

<!-- Service Worker ë“±ë¡ (PWA) -->
<script>
// â˜…â˜…â˜… Service Worker ë° ì—ì…‹ ìºì‹± ì‹œìŠ¤í…œ â˜…â˜…â˜…
if ('serviceWorker' in navigator) {
    window.addEventListener('load', async () => {
        try {
            const reg = await navigator.serviceWorker.register('sw.js');
            console.log('âœ… Service Worker ë“±ë¡ ì„±ê³µ:', reg.scope);

            // ì²« ì„¤ì¹˜ ë˜ëŠ” ì—…ë°ì´íŠ¸ ì‹œ ë‹¤ìš´ë¡œë“œ ì§„í–‰ í‘œì‹œ
            if (reg.installing || reg.waiting) {
                showDownloadProgress(reg.installing || reg.waiting);
            }

            reg.addEventListener('updatefound', () => {
                const newWorker = reg.installing;
                if (newWorker) {
                    showDownloadProgress(newWorker);
                }
            });

            // ì´ë¯¸ í™œì„±í™”ëœ ê²½ìš° ìºì‹œ ìƒíƒœ í™•ì¸
            if (reg.active) {
                checkCacheStatus();
            }
        } catch (err) {
            console.log('âŒ Service Worker ë“±ë¡ ì‹¤íŒ¨:', err);
        }
    });
}

// ë‹¤ìš´ë¡œë“œ ì§„í–‰ ìƒí™© í‘œì‹œ
function showDownloadProgress(worker) {
    const statusDiv = document.getElementById('asset-download-status');
    const progressFill = document.getElementById('download-progress-fill');
    const downloadInfo = document.getElementById('download-info');
    const downloadText = statusDiv?.querySelector('.download-text');

    if (!statusDiv) return;

    statusDiv.style.display = 'block';

    worker.addEventListener('statechange', () => {
        if (worker.state === 'installed') {
            // ì„¤ì¹˜ ì™„ë£Œ
            statusDiv.classList.add('complete');
            if (downloadText) downloadText.textContent = 'âœ“ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!';
            if (progressFill) progressFill.style.width = '100%';
            if (downloadInfo) downloadInfo.textContent = 'ì˜¤í”„ë¼ì¸ í”Œë ˆì´ ê°€ëŠ¥';

            // 3ì´ˆ í›„ ìˆ¨ê¹€
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        } else if (worker.state === 'activating') {
            if (downloadText) downloadText.textContent = 'ìºì‹œ í™œì„±í™” ì¤‘...';
        }
    });

    // ì§„í–‰ ìƒí™© ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ ì§„í–‰ë¥ ì€ SWì—ì„œ ì•Œ ìˆ˜ ì—†ìŒ)
    let progress = 0;
    const interval = setInterval(() => {
        if (progress < 90) {
            progress += Math.random() * 15;
            if (progressFill) progressFill.style.width = Math.min(90, progress) + '%';
        }
        if (worker.state === 'installed' || worker.state === 'activated') {
            clearInterval(interval);
        }
    }, 500);
}

// ìºì‹œ ìƒíƒœ í™•ì¸
async function checkCacheStatus() {
    if ('caches' in window) {
        try {
            const cache = await caches.open('solar-game-v1');
            const keys = await cache.keys();
            console.log('ğŸ“¦ ìºì‹œëœ íŒŒì¼:', keys.length);

            // ìºì‹œê°€ ë¹„ì–´ìˆìœ¼ë©´ ë‹¤ìš´ë¡œë“œ í‘œì‹œ ì•ˆ í•¨ (SWê°€ ìë™ ì²˜ë¦¬)
            if (keys.length === 0) {
                console.log('ì²« ë°©ë¬¸ - ì—ì…‹ ìºì‹± ì‹œì‘ë¨');
            }
        } catch (e) {
            console.warn('ìºì‹œ í™•ì¸ ì‹¤íŒ¨:', e);
        }
    }
}

// PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    console.log('ğŸ“± PWA ì„¤ì¹˜ ê°€ëŠ¥');
});
</script>

</body>
</html>
